

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Part 2: 单一事件的贝叶斯模型 &#8212; Bayesian Inference with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter1_Bayesrule/Bayesrule_part2';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part 3: 随机变量的贝叶斯模型" href="Bayesrule_part3.html" />
    <link rel="prev" title="Part 1: 【和鲸平台】整合教学+练习" href="Bayesrule_part1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../chapter_overview/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Bayesian Inference with Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Bayesian Inference with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../chapter_overview/intro.html">
                    序言
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">0. 课程概述</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter_overview/Part1.html">为什么要学习贝叶斯推断?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_overview/Part2.html">三个使用贝叶斯的例子</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_overview/Part3.html">本课程的主要内容与形式</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">1. 初识贝叶斯法则(Bayes'Rule)</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Bayesrule_part1.html">1.0 本课程演示平台 —— 和鲸平台</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1.1 单一事件的贝叶斯模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bayesrule_part3.html">1.2 随机变量的贝叶斯模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bayesrule_part4.html">1.3 贝叶斯与频率主义的简单对比</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2. 一个真正的贝叶斯模型——Beta-Binomial Model</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part1.html">2.0 先验分布 —— Beta分布</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part2.html">2.1 似然函数 —— Binomial分布</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part3.html">2.2 后验分布</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part4.html">2.3 通过模拟可视化来观察模型</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hcp4715/PyBayesianBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hcp4715/PyBayesianBook/issues/new?title=Issue%20on%20page%20%2Fchapter1_Bayesrule/Bayesrule_part2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter1_Bayesrule/Bayesrule_part2.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Part 2: 单一事件的贝叶斯模型</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1、心理学研究的可重复性问题</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2、基本概念介绍与代码实操</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="part-2">
<h1>Part 2: 单一事件的贝叶斯模型<a class="headerlink" href="#part-2" title="Permalink to this heading">#</a></h1>
<p><font size=6>思考：</font></p>
<p><font size=5>当你读文献时，是否有一个疑问：</p>
<p>  我看到的这个文章靠谱吗？</font></p>
<center><img width = '220' height ='200' src="image.png">
<img width = '220' height ='200' src="image-1.png">
</center>
<section id="id1">
<h2>1、心理学研究的可重复性问题<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p><strong><font size=5>
1.1  2015年的一项研究</strong>
</font><br></p>
<p>  2015年，<strong>开放科学合作组织</strong>（Open Science Collaboration）在《Science》杂志上发表文章，发现只有36% ~ 47%的认知/社会心理学研究成果能被成功重复。</p>
<center><img width = '650' height ='300' src="image-2.png">
</center>
<p><a class="reference external" href="https://www.science.org/doi/abs/10.1126/science.aac4716">Open Science Collaboration. (2015). Estimating the reproducibility of psychological science. Science, 349(6251), aac4716.</a>
<br></p>
<ul class="simple">
<li><p><strong>问题1：当你在知道这个可重复性比例之前和之后，对这个可重复问题的信念是否发生了变化？</strong></p></li>
</ul>
<p><strong><font size=5> 1.2  2024年的一项新研究</strong></font></p>
<p>  2024年，一项针对299项预注册的重复实验数据的研究发现，可重复研究通常以自信、透明和确切的语言撰写，而不可重复的研究则往往表现出模糊性，并使用“边缘型”的说服技巧。</p>
<p>  这个新研究可能帮助我们<strong>更新</strong>了对心理学科学论文的预测。</p>
<center><img width = '650' height ='230' src="image-3.png">
</center>
<p><a class="reference external" href="https://journals.sagepub.com/doi/abs/10.1177/09567976241254037">Herzenstein, M., Rosario, S., Oblander, S., &amp; Netzer, O. (2024). The Language of (Non) Replicable Social Science. Psychological Science, 09567976241254037.</a></p>
<ul class="simple">
<li><p><strong>问题2：假定我们现在从上述299个文章中抽取出一篇论文，我们如何评估它的可重复性？</strong></p></li>
</ul>
<p><strong><font size=5> 1.3  整合两项研究给出的信息——证据更新</strong></font></p>
<p>  根据Herzenstein等（2024）的研究结果，可重复的研究中，有56%的文章使用确切的语言风格；在不可重复的研究中，使用确切语言的比例为45%。</p>
<p>  整合2015和2024年的研究，我们可以得到以下几个关键信息：</p>
<ul class="simple">
<li><p>心理学研究<font color=#EEB4B4>可重复</font>的概率为40%</p></li>
<li><p>心理学研究<font color=#CD950C>不可重复</font>的概率为60%</p></li>
<li><p><font color=#EEB4B4>可重复</font>的研究中，<font color=#87CEEB>使用确切语言</font>的概率为56%</p></li>
<li><p><font color=#CD950C>不可重复</font>的研究中，<font color=#87CEEB>使用确切语言</font>的概率为45%</p></li>
</ul>
<center><img width = '240' height ='250' src="image-5.png">
</center>
<p>因此，根据上述所有信息，我们可以进行以下运算并对其可视化：</p>
<ul class="simple">
<li><p>研究<font color=#EEB4B4>可重复</font>且<font color=#87CEEB>使用确切语言</font>的概率 <span class="math notranslate nohighlight">\( P = 0.40 × 0.56 = 0.224 \)</span></p></li>
<li><p>研究<font color=#EEB4B4>可重复</font>但<font color=#FFD700>不使用确切语言</font>的概率 <span class="math notranslate nohighlight">\( P = 0.40×（1-0.56）=0.176 \)</span></p></li>
<li><p>研究<font color=#CD950C>不可重复</font>但<font color=#87CEEB>使用确切语言</font>的概率 <span class="math notranslate nohighlight">\( P = 0.60 × 0.45 = 0.27 \)</span></p></li>
<li><p>研究<font color=#CD950C>不可重复</font>且<font color=#FFD700>不使用确切语言</font>的概率 <span class="math notranslate nohighlight">\( P = 0.60 × （1-0.45）=0.33 \)</span>
<img alt="alt text" src="../_images/image-4.png" /></p></li>
</ul>
<p><strong>因此，假如我们抽取一个文章<font color=#87CEEB>使用了确切的语言风格</font>，我们认为它<font color=#EEB4B4>可重复</font>的可能性是：
<span class="math notranslate nohighlight">\(P = 0.224/（0.224 + 0.27） = 0.453\)</span></strong></p>
</section>
<section id="id2">
<h2>2、基本概念介绍与代码实操<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>在这个简单的例子当中，我们实际进行了一次“<strong>贝叶斯的证据更新</strong>”</p></li>
</ul>
<p>  接下来我们再来重新审视一下这个事例。</p>
<p>  我们选取Herzenstein 等（2024）年的部分真实数据进行探索，包括研究的编号 (title)，文章是否可被重复 (replicated), 文章结果描述的确切性 (certain)和文章表述的积极性 (posemo)。</p>
<ul class="simple">
<li><p>需要事先安装的包以及版本号：</p></li>
</ul>
<p>In [1]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 非选课的同学，可以使用和鲸社区的Python镜像，运行以下的代码安装必要的模块，需要3-5分钟的时间完成加载</span>
<span class="c1"># 后续会有专门的社区公开镜像，给大家提前配置好运行环境</span>
<span class="c1"># 将下列代码行解除注释，删除“#”，运行即可：</span>
<span class="c1"># !conda install -y graphviz bambi=0.13.0 pymc=5.16.2 PreliZ=0.9.0 ipympl=0.9.4 pingouin=0.5.4</span>

<span class="c1"># docker部署和使用教程链接：https://zhuanlan.zhihu.com/p/719739087</span>
<span class="c1"># docker pull hcp4715/pybaysian:latest</span>
<span class="c1"># docker run -it --rm -p 8888:8888 hcp4715/pybaysian:latest</span>
</pre></div>
</div>
<p>In [2]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 导入数据加载和处理包：pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># 导入数字和向量处理包：numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># 导入基本绘图工具：matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># 使用 pandas 导入示例数据</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/home/mw/input/bayes3797/replicated_language_cleaned.csv&quot;</span><span class="p">)</span> 
<span class="k">except</span><span class="p">:</span>
  <span class="n">df</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/replicated_language_cleaned.csv&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;study_name&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># 设置APA 7的画图样式</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>      <span class="c1"># 设置画布大小</span>
    <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>               <span class="c1"># 设置字体大小</span>
    <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>          <span class="c1"># 标题字体大小</span>
    <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>          <span class="c1"># 轴标签字体大小</span>
    <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>         <span class="c1"># x轴刻度字体大小</span>
    <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>         <span class="c1"># y轴刻度字体大小</span>
    <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>          <span class="c1"># 线宽</span>
    <span class="s1">&#39;axes.linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>           <span class="c1"># 轴线宽度</span>
    <span class="s1">&#39;axes.edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>     <span class="c1"># 设置轴线颜色为黑色</span>
    <span class="s1">&#39;axes.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>     <span class="c1"># 轴背景颜色（白色）</span>
    <span class="s1">&#39;xtick.direction&#39;</span><span class="p">:</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span>       <span class="c1"># x轴刻度线向内</span>
    <span class="s1">&#39;ytick.direction&#39;</span><span class="p">:</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span>      <span class="c1"># y轴刻度线向内和向外</span>
    <span class="s1">&#39;xtick.major.size&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>         <span class="c1"># x轴主刻度线长度</span>
    <span class="s1">&#39;ytick.major.size&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>         <span class="c1"># y轴主刻度线长度</span>
    <span class="s1">&#39;xtick.minor.size&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>         <span class="c1"># x轴次刻度线长度（如果启用次刻度线）</span>
    <span class="s1">&#39;ytick.minor.size&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>         <span class="c1"># y轴次刻度线长度（如果启用次刻度线）</span>
    <span class="s1">&#39;xtick.major.width&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>        <span class="c1"># x轴主刻度线宽度</span>
    <span class="s1">&#39;ytick.major.width&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>        <span class="c1"># y轴主刻度线宽度</span>
    <span class="s1">&#39;xtick.minor.width&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>      <span class="c1"># x轴次刻度线宽度（如果启用次刻度线）</span>
    <span class="s1">&#39;ytick.minor.width&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>      <span class="c1"># y轴次刻度线宽度（如果启用次刻度线）</span>
    <span class="s1">&#39;ytick.labelleft&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>       <span class="c1"># y轴标签左侧显示</span>
    <span class="s1">&#39;ytick.labelright&#39;</span><span class="p">:</span> <span class="kc">False</span>      <span class="c1"># 禁用y轴标签右侧显示</span>
<span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p><strong><font size=5> 2.1  先验（prior）与数据（data）</strong></font></p>
<p>  重新回顾我们要评估的事件：我们认为从299项心理学研究中随机选出来的一项研究的可重复性如何？</p>
<p>  在评估这个事件之前，我们知道Science于2015年发表了一个大规模重复实验，发现40%的心理学研究是可以被重复出来。</p>
<p>对于这299项研究，它们有不同的语言风格：</p>
<p>In [3]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 数据预处理</span>
<span class="c1"># 计算 &#39;certain&#39; 列的中位数</span>
<span class="n">median_certain</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;certain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="c1"># 创建新列，编码规则：大于中位数为 1，小于等于中位数为 2</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;language_style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;certain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">median_certain</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># 输出结果</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>  研究能否被重复出来，与他们的语言风格有关系：</p>
<ul class="simple">
<li><p>有 56%（71/126）的能被重复的研究使用了确切的语言风格；</p></li>
<li><p>约 45%（78/173）的不能被重复研究使用了确切的语言风格。</p></li>
</ul>
<p>In [4]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 计算不同水平的数量和百分比</span>
<span class="n">level_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">level_percentages</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># 百分比保留两位小数</span>
<span class="n">level_percentages</span> <span class="o">=</span> <span class="n">level_percentages</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># 创建一个新的 DataFrame 合并结果</span>
<span class="n">result_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;数量&#39;</span><span class="p">:</span> <span class="n">level_counts</span><span class="p">,</span> <span class="s1">&#39;百分比&#39;</span><span class="p">:</span> <span class="n">level_percentages</span><span class="p">})</span>
<span class="c1"># 展示结果(0代表不可重复，1代表可重复)</span>
<span class="n">result_df1</span>
</pre></div>
</div>
<p>In [5]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 计算不同水平的数量</span>
<span class="n">result_df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;replicated&#39;</span><span class="p">,</span> <span class="s1">&#39;language_style&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="c1"># 结果</span>
<span class="n">result_df2</span>
</pre></div>
</div>
<p><strong><font size=5>所以，什么是先验？</strong></font></p>
<ul class="simple">
<li><p><strong>先验（prior）：指没有观察到具体数据之前，根据已有知识、经验或主观判断对某个事件发生概率的初步估计。</strong></p></li>
</ul>
<p>  在我们这个事件中，我们评估某项研究可重复性之前，我们关于研究可重复性的信念，在贝叶斯统计中被称为 <strong>先验（prior）</strong>。</p>
<p>  假设我们的信念被2015年Science的文章所影响，相信约40%的心理学实验是可重复的，这就是我们开始了解这项研究前的信念。</p>
<p>  本例中，40%的估计代表了我们基于已有文献和领域经验的先验信念——即在没有观察具体文章之前，推测它有40%的研究能够成功重复。</p>
<br>
<p><strong><font size=5>先验 vs 数据</strong></font></p>
<p>  在了解到被评估的研究来自Herzenstein 等（2024）之后，我们又获得了新的信息，这个新信息我们将其称为 <strong>数据（data）</strong>。</p>
<p>此时，我们会有两个信息：</p>
<ul class="simple">
<li><p>先验信息 (prior)：约 40% 的研究是可重复。</p></li>
<li><p>数据 (data) ：有 56%能被重复的研究使用了确切的语言风格，约45%不能被重复研究使用了确切的语言风格。</p></li>
</ul>
<p>那么请思考一个问题：我们该如何推断？是在先验和数据之间找到平衡吗？</p>
<p>如果你也这么想，那么恭喜你，这正是贝叶斯的思路：</p>
<ul class="simple">
<li><p><strong>基于数据对先验进行更新。</strong></p></li>
</ul>
<center>
<p><span class="math notranslate nohighlight">\( Posterior=\frac {data*prior} {Average \ probability \ of \ data} \)</span></p>
<img width = '600' height ='280' src="image-6.png">
</center>
<p><strong><font size=5> 2.2  先验概率（Prior probability）</strong></font></p>
<p>我们现在使用更加正式一点的语言来对上述的信息进行描述：</p>
<ul class="simple">
<li><p>假如一项心理学研究能够被其他研究者独立地重复出来，我们认为一个特定的事件<strong>发生了</strong></p></li>
</ul>
<p>                ————我们将这个事件使用B来表示</p>
<ul class="simple">
<li><p>假如一项心理学研究不能被其他研究者独立地重复出来，我们认为一个特定的事件<strong>没有发生</strong></p></li>
</ul>
<p>                ————我们使用符号<span class="math notranslate nohighlight">\( B^c \)</span>(B的补集complement)来表示</p>
<p>根据Science于2015年的文章，我们可以得以下公式：</p>
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>事件</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B^c \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( Total \)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>probability</p></td>
<td class="text-center"><p>0.4</p></td>
<td class="text-center"><p>0.6</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
</div>
<p>  换一句话说，在我们对需要被评估的研究进行评估前，我们关于事件 B 的先验信念是 <span class="math notranslate nohighlight">\(P(B)\)</span>，这也被称为<strong>先验模型(prior model)</strong></p>
<ul class="simple">
<li><p>作为一个有效的概率模型(valid probability model)，它必须：</p></li>
</ul>
<p>（1）考虑所有可能的事件（所有文章都必须是可重复或不可重复的，没有其他可能性）</p>
<p>（2）它为每个事件分配先验概率</p>
<p>（3）这些概率加起来为1</p>
<br>
<p><strong><font size=5> 2.3  数据模型（条件概率与似然性）</strong></font></p>
<p>  借鉴先验模型的构建方式，我们同样可以采用模型（即公式）对关于目标研究的新信息进行正式地描述。</p>
<p>          ————我们用符号A表示研究中使用了确切的语言风格。</p>
<p>  我们要将如下一句话的信息进行形式化：</p>
<ul class="simple">
<li><p>有 56%能被重复的研究使用了确切的语言风格；约45%不能被重复研究使用了确切的语言风格。
<br></p></li>
<li><p>有 56%能被重复的研究使用了确切的语言风格，44%的能被重复的研究没有使用确切的语言风格；约45%不能被重复研究使用了确切的语言风格；55%的不能被重复的研究没有使用确切的语言风格。</p></li>
</ul>
<p>将数据形式化，通过条件概率来量化文章展现出语言确切的可能性。具体如下：</p>
<ul class="simple">
<li><p>当研究是可重复的，使用确切语言的概率大约为56%。 <span class="math notranslate nohighlight">\( P（A|B） \)</span>≈ 56%</p></li>
<li><p>当研究不可重复的情况下，使用确切语言的概率大约为45%。 <span class="math notranslate nohighlight">\( P（A|B^c） \)</span>≈ 45%</p></li>
</ul>
<center><img width = '700' height ='340' src="image-7.png">
</center>
<br>
<p><strong><font size=4> 2.3.1  条件概率</strong></font></p>
<p><strong>条件概率：给定某个条件下发生另一件事情的概率。</strong></p>
<p><em>注意：条件概率的定义是有顺序的，<span class="math notranslate nohighlight">\( P(A|B) \)</span>与<span class="math notranslate nohighlight">\( P(B|A) \)</span>并不相等。</em></p>
<p>例如：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( P(A|B) \)</span>表示在研究可重复的情况下，使用确切语言的概率（B是前提，A是结果）</p></li>
<li><p><span class="math notranslate nohighlight">\( P(B|A) \)</span>表示的是在研究使用确切语言的情况下，该研究是可重复的概率（A是前提，B是结果）</p></li>
</ul>
<p>很多时候，人们容易混淆这两者，尤其在贝叶斯推理中。因此，<strong>清楚条件的前提和结果</strong>是很重要的。</p>
<p><strong><font size=4> 2.3.2  似然（likelihood）</strong></font></p>
<p>从条件概率中，我们知道 <span class="math notranslate nohighlight">\( P（A|B）= 0.56 \)</span>, <span class="math notranslate nohighlight">\( P（A|B^c） \)</span>= 0.45，即使用确切语言的研究更可能是可重复的。</p>
<ul class="simple">
<li><p><strong>似然（likelihood）：描述的是在不同假设下，某个数据模式出现的可能性。</strong></p></li>
</ul>
<p>在这个例子中，我们比较两种假设：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( P（A|B） \)</span>= 0.56：在可重复研究的假设下，使用确切语言的概率较高。</p></li>
<li><p><span class="math notranslate nohighlight">\( P（A|B^c） \)</span>= 0.45：在不可重复研究的假设下，使用确切语言的概率较低。</p></li>
</ul>
<p>因此，似然函数表明：当前数据模式（使用确切语言）在可重复的假设下更可能出现：
<span class="math notranslate nohighlight">\( P（A|B） \)</span>= 0.56 &gt; <span class="math notranslate nohighlight">\( P（A|B^c） \)</span>= 0.45</p>
<p><strong><font color=#EE3B3B>这就是似然函数(likelihood function)的核心：反映了在不同的假设（可重复或不可重复）下，某个数据 A 出现的可能性。</strong></font></p>
<p>例如，针对“数据A：研究使用确切语言”的似然可以写成：<span class="math notranslate nohighlight">\( L(*|A) \)</span></p>
<p>    <span class="math notranslate nohighlight">\( L(B|A) = P(A|B) \)</span>     <span class="math notranslate nohighlight">\( L(B^c|A) = P(A|B^c) \)</span></p>
<p>上述两个式子分别表示在“研究可重复”和“研究不可重复”两种可能的情况下，使用确切语言的概率。</p>
<p><em>注意，在似然函数中，数据是已知发生的，而假设是可能发生的。</em>
<br></p>
<ul class="simple">
<li><p><strong>概率(Probability) vs 似然(likelihood)</strong></p></li>
</ul>
<p>概率和似然似乎都在表示某种可能性，它们的区别是什么呢？</p>
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>特性</p></th>
<th class="head text-center"><p>概率 (Probability)</p></th>
<th class="head text-center"><p>似然 (Likelihood)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>定义</p></td>
<td class="text-center"><p>已知假设条件，得到某个数据的可能性</p></td>
<td class="text-center"><p>已知数据，不同假设条件下得到该数据的可能性</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>范围</p></td>
<td class="text-center"><p>[0, 1]</p></td>
<td class="text-center"><p>不限于[0, 1]</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>总和</p></td>
<td class="text-center"><p>所有可能事件的总和为1</p></td>
<td class="text-center"><p>可以不等于1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>应用</p></td>
<td class="text-center"><p>预测和决策</p></td>
<td class="text-center"><p>模型估计和选择</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>注意：</strong></p>
<ul class="simple">
<li><p>先验概率的总和等于1，因为先验表示所有可能结果的分布，表示事件B发生的概率，是我们的主观推测</p></li>
<li><p>似然总和不等于1，因为似然函数不是概率函数，它告诉我们事件A在不同假设下发生的相对可能性。</p></li>
</ul>
<p>根据我们的例子，概率和似然可以整理为下表：</p>
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>event</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B^c \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( total \)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>prior</p></td>
<td class="text-center"><p>0.4</p></td>
<td class="text-center"><p>0.6</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>likelihood</p></td>
<td class="text-center"><p>0.56</p></td>
<td class="text-center"><p>0.45</p></td>
<td class="text-center"><p>≠1</p></td>
</tr>
</tbody>
</table>
</div>
<br>
<p><strong><font size=5> 2.4  分母（normalizing constant）– 边际概率 (marginal probability)</strong></font></p>
<p>  似然函数描述了在可重复性研究和不可重复研究中使用确切语言的情况。</p>
<ul class="simple">
<li><p>我们想知道的是：所有研究中使用自信语言的总体可能性是多少，这被称为<strong>边际概率 <span class="math notranslate nohighlight">\( P(A) \)</span></strong></p></li>
</ul>
<p>  我们要做的，就是把每个假设下出现事件 A 的似然与每个假设本身的概率相乘（即把每个假设自身的概念纳入考虑），这两者之和即为边际概率。</p>
<center>
<p><span class="math notranslate nohighlight">\( P(A)=P(A \bigcap B)+P(A \bigcap B^c)=L(B|A)*P(B)+L(B^c|A)*P(B^c) \)</span></p>
<p><span class="math notranslate nohighlight">\( P(A)=0.56*0.4+0.45*0.6=0.494 \)</span></p>
</center>
<br>
<p><strong><font size=5> 2.5  后验概率模型 (Posterior probability model via Bayes’ Rule)</strong></font></p>
<p><strong>直觉理解</strong></p>
<p>最后，我们来计算后事件 B 的后验概率，即，当我们知道某个研究使用了确切的语言风格之后，它能被重复的可能性是多少？</p>
<p>我们同样通过条件概率来描述它： <span class="math notranslate nohighlight">\( P(B|A) \)</span>。</p>
<p>在正式计算之前，我们可以回顾一下这个表格来建立一些直觉。</p>
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B^c \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( Total \)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\( A \)</span></p></td>
<td class="text-center"><p>0.56 * 0.4 = 0.224</p></td>
<td class="text-center"><p>0.45* 0.6 = 0.27</p></td>
<td class="text-center"><p>0.494</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\( A^c \)</span></p></td>
<td class="text-center"><p>0.176</p></td>
<td class="text-center"><p>0.33</p></td>
<td class="text-center"><p>0.506</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\( Total \)</span></p></td>
<td class="text-center"><p>0.4</p></td>
<td class="text-center"><p>0.6</p></td>
<td class="text-center"><p>1.0</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( A \)</span>：表示使用确切语言的研究</p></li>
<li><p><span class="math notranslate nohighlight">\( A^c \)</span>：表示不使用确切语言的研究</p></li>
<li><p><span class="math notranslate nohighlight">\( B \)</span>：表示研究是可重复的</p></li>
<li><p><span class="math notranslate nohighlight">\( B^c \)</span>：表示研究是不可重复的</p></li>
</ul>
<p>因为我们知道这项研究使用确切语言风格，所以我们直接锁定第一行，</p>
<ul class="simple">
<li><p>在A行中，45.3%(0.224/0.494)的研究是可重复的，54.7%(0.27/0.494)的研究是不可重复的。</p></li>
<li><p>因此，根据后验概率 45.3%的可能性可以认为当前这一研究是可重复的。</p></li>
</ul>
<br>
<p><strong>正式计算</strong></p>
<p>如何凭借贝叶斯公式的数学形式推导得到该结果？
<font size=3>
<span class="math notranslate nohighlight">\( Posterior \thicksim P(B|A)=\frac {data*prior} {Average \ probability \ of \ data}=\frac {P(A\bigcap B)} {P(A)}=\frac {L(B|A)*P(B)} {L(B|A)*P(B)+L(B^c|A)*P(B^c)} \)</span>
</font></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( P(B|A)=\frac {P(B)L(B|A)} {P(A)}=\frac {0.4*0.56} {0.494}=0.453 \)</span></p></li>
<li><p>当带入之前计算得到的数值到贝叶斯公式中，我们得到了确切语言为可重复研究的概率。</p></li>
</ul>
<p>使用同样的方法，我们可以计算出使用确切语言的研究为不可重复研究的概率，结果如下表</p>
<ul class="simple">
<li><p>可以注意到：先验概率和后验概率的和均等于1</p></li>
</ul>
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>event</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( B^c \)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\( Total \)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>prior probability</p></td>
<td class="text-center"><p>0.4</p></td>
<td class="text-center"><p>0.6</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>posterior probability</p></td>
<td class="text-center"><p>0.453</p></td>
<td class="text-center"><p>0.547</p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><strong>思考时间：是否加入分母的意义何在？</strong></p></li>
</ul>
<br>
<p><strong>后验概率计算模拟练习</strong></p>
<p>  为了深入理解先验知识、似然（数据）和后验概率，我们将通过编写代码来计算后验概率，以增强对这些概念的理解和实践能力。</p>
<p>1、定义研究的可重复性与相应的先验概率</p>
<p>In [6]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 定义文章类型</span>
<span class="n">article</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;replicated&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">]})</span>
<span class="c1"># 定义先验概率</span>
<span class="n">prior</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
</pre></div>
</div>
<p>2、模拟一些可能被投放给你的研究</p>
<p>In [7]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 模拟生成 10000 项研究，包括其类型</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">84735</span><span class="p">)</span>
<span class="n">article_sim</span> <span class="o">=</span> <span class="n">article</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># 查看前 10 行数据</span>
<span class="n">article_sim</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<center><img width = '140' height ='340' src="image-10.png">
</center>
<p>In [8]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#我们可以通过画图来查看这些被投放研究的可重复性比例。</span>
<span class="n">article_sim</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<center><img width = '320' height ='240' src="image-11.png">
</center>
<p>3、接下来，我们需要模拟10000项研究使用确切语言风格的情况</p>
<ul class="simple">
<li><p>和之前相同，不可重复研究使用确切语言风格的可能性为45%，可重复研究使用确切语言风格的可能性为56%。</p></li>
</ul>
<p>In [9]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 设置条件概率</span>
<span class="n">article_sim</span><span class="p">[</span><span class="s1">&#39;data_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">article_sim</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">)</span>

<span class="c1"># 定义研究是否使用确切语言</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;certain&#39;</span><span class="p">,</span> <span class="s1">&#39;uncertain&#39;</span><span class="p">]</span>

<span class="c1"># 设置随机种子，以便得到重复的结果</span>
<span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">84735</span><span class="p">)</span>
<span class="c1"># 生成确切语言相关的数据</span>
<span class="n">article_sim</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">article_sim</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">data_model</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">data_model</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>In [10]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 显示每个类别研究数量</span>
<span class="p">(</span>
  <span class="n">article_sim</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;replicated&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>language / replicated</p></th>
<th class="head text-center"><p>no</p></th>
<th class="head text-center"><p>yes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>certain</p></td>
<td class="text-center"><p>2643</p></td>
<td class="text-center"><p>2340</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>uncertain</p></td>
<td class="text-center"><p>3330</p></td>
<td class="text-center"><p>1687</p></td>
</tr>
</tbody>
</table>
</div>
<p>4、计算后验值
还记得我们的先验概率为：</p>
<ul class="simple">
<li><p>可重复研究 <span class="math notranslate nohighlight">\( P(B) \)</span>=0.4</p></li>
<li><p>不可重复性研究 <span class="math notranslate nohighlight">\( P(B^c) \)</span>=0.6</p></li>
</ul>
<p>由以上结果可计算似然：</p>
<ul class="simple">
<li><p>大约58.1%(2340/(2340+1687))的可重复性研究使用了确切语言, <span class="math notranslate nohighlight">\( P(A|B) \)</span> = 0.581</p></li>
<li><p>44.2%的不可重复性研究使用确切语言(2643/(3330+2643)), <span class="math notranslate nohighlight">\( P(A|B^c) \)</span> = 0.442</p></li>
</ul>
<p>结合先验和似然，我们可以进一步计算分母(边际概率)：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( L(B|A)×P(B) + L(B^c|A)×P(B^c) = 0.581×0.4 + 0.442×0.6 = 0.2324 + 0.2652 ≈ 0.498 \)</span></p></li>
</ul>
<p>最后，我们可以计算得到的后验（使用确切语言研究中，可重复性研究的概率）：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( P(B|A) = L(B|A)×P(B) / P(A) = (0.581×0.4) / 0.498 ≈ 0.467 \)</span></p></li>
<li><p>在10000项研究中，使用确切语言的研究有4980篇(分母)</p></li>
<li><p>而现在，我们可以知道，在使用确切语言的研究中，47%(2340/4980)的研究为可重复研究</p></li>
</ul>
<p>In [11]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">usage_yes</span> <span class="o">=</span> <span class="n">article_sim</span><span class="p">[</span><span class="n">article_sim</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;certain&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;使用确切语言的研究&#39;</span><span class="p">,</span> <span class="n">usage_yes</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">usage_yes</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
<center><img width = '240' height ='120' src="image-12.png">
</center>
<p>同样地，通过画图来可视化使用确切语言的研究的情况:</p>
<p>In [12]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 定义两幅图的坐标</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># 绘制两幅图</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">article_sim</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">article_sim</span><span class="p">[</span><span class="n">article_sim</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;replicated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;language = </span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span> 

<span class="c1"># 显示   </span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<center><img width = '560' height ='320' src="image-13.png">
</center>
<br>
<p><strong>总结 (Recap)</strong></p>
<p>回到之前的问题：如何预测研究的可重复性？</p>
<p><img alt="alt text" src="../_images/image-14.png" /></p>
<p>尝试回答：</p>
<ul class="simple">
<li><p>哪些信念可以作为先验概率？</p></li>
<li><p>信息的哪些属性可以作为数据？</p></li>
<li><p>如何结合先验和数据更新信念 (贝叶斯公式)？</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter1_Bayesrule"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Bayesrule_part1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Part 1: 【和鲸平台】整合教学+练习</p>
      </div>
    </a>
    <a class="right-next"
       href="Bayesrule_part3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part 3: 随机变量的贝叶斯模型</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1、心理学研究的可重复性问题</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2、基本概念介绍与代码实操</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr. Hu Chuan-Peng
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
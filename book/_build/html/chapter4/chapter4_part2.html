
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.1 Grid approximation ç½‘æ ¼è¿‘ä¼¼ &#8212; Bayesian Inference with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter4/chapter4_part2';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Leture6: MCMC" href="../chapter5/chapter5_part1.html" />
    <link rel="prev" title="Lecture 5: Bayesian Inference: From Traditional Foundations to Current Practices" href="chapter4_part1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../chapter_overview/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Bayesian Inference with Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Bayesian Inference with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../chapter_overview/intro.html">
                    åºè¨€
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">0. è¯¾ç¨‹æ¦‚è¿°</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter_overview/Part1.html">ä¸ºä»€ä¹ˆè¦å­¦ä¹ è´å¶æ–¯æ¨æ–­?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_overview/Part2.html">è´å¶æ–¯æ¨æ–­çš„ä¸‰ä¸ªä¾‹å­</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_overview/Part3.html">æœ¬è¯¾ç¨‹çš„ä¸»è¦å†…å®¹ä¸å½¢å¼</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">1. åˆè¯†è´å¶æ–¯æ³•åˆ™(Bayes'Rule)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter1_Bayesrule/Bayesrule_part1.html">1.0 æœ¬è¯¾ç¨‹æ¼”ç¤ºå¹³å°: å’Œé²¸å¹³å°</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter1_Bayesrule/Bayesrule_part2.html">1.1 å•ä¸€äº‹ä»¶çš„è´å¶æ–¯æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter1_Bayesrule/Bayesrule_part3.html">1.2 éšæœºå˜é‡çš„è´å¶æ–¯æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter1_Bayesrule/Bayesrule_part4.html">1.3 è´å¶æ–¯ä¸é¢‘ç‡ä¸»ä¹‰çš„ç®€å•å¯¹æ¯”</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2. ä¸€ä¸ªçœŸæ­£çš„è´å¶æ–¯æ¨¡å‹â€”â€”Beta-Binomial Model</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part1.html">2.0 å…ˆéªŒåˆ†å¸ƒ: Betaåˆ†å¸ƒ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part2.html">2.1 ä¼¼ç„¶å‡½æ•°: Binomialåˆ†å¸ƒ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part3.html">2.2 åéªŒåˆ†å¸ƒ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter2_Beta_Binomial/BetaBinomial_part4.html">2.3 é€šè¿‡æ¨¡æ‹Ÿå¯è§†åŒ–æ¥è§‚å¯Ÿæ¨¡å‹</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3. Balance and Sequentiality in Bayesian Analyses</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter3/Lecture4_part1.html">3.0 å›é¡¾Bayes'Rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter3/Lecture4_part2.html">3.1 ä¸åŒæ•°æ®å¯¹åéªŒçš„å½±å“</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter3/Lecture4_part3.html">3.2 ä¸åŒä¼¼ç„¶å¯¹åéªŒçš„å½±å“</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter3/Lecture4_part4.html">3.3 ä¸åŒå…ˆéªŒå¯¹åéªŒçš„å½±å“</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">4. Bayesian Inference:From Traditional Foundations to Current Practices</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter4_part1.html">4.0 å†…å®¹å›é¡¾</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4.1 Grid approximation ç½‘æ ¼è¿‘ä¼¼</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">5. Markov Chain Monte Carlo(MCMC)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter5/chapter5_part1.html">5.0 Monte Carlo &amp; Markov Chain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter5/chapter5_part2.html">5.1 Metropolis-Hastings(MH)ç®—æ³•</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">6. Posterior Inference &amp; Estimation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter6/chapter6_part1.html">6.0 A Beta-Binomial example in pymc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter6/chapter6_part2.html">6.1 MCMCè¯Šæ–­</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">7. A Simple Linear Regression Model with PyMC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter7/chapter7_part1.html">7.0 è´å¶æ–¯ä¸€èˆ¬çº¿æ€§å›å½’æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter7/chapter7_part2.html">7.1 å…ˆéªŒé¢„æµ‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter7/chapter7_part3.html">7.2 åéªŒé¢„æµ‹</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">8. Bayes Factor</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter8/chapter8_part1.html">8.0 ä¼ ç»Ÿé›¶å‡è®¾æ˜¾è‘—æ€§æ£€éªŒ vs è´å¶æ–¯å› å­</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter8/chapter8_part2.html">8.1 è´å¶æ–¯å› å­çš„è®¡ç®—ä¸åº”ç”¨</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">9. Multivariable linear regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter9/chapter9_part1.html">9.0 ä¸‰æ°´å¹³çš„ç®€å•çº¿æ€§å›å½’æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter9/chapter9_part2.html">9.1 2Ã—3çš„å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ï¼šæ— äº¤äº’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter9/chapter9_part3.html">9.2 2Ã—3çš„å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ï¼šæœ‰äº¤äº’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter9/chapter9_part4.html">9.3 ç»ƒä¹ </a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">10. Evaluating Regression Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter10/chapter10_part1.html">10.0 è´å¶æ–¯å›é¡¾æ¨¡å‹çš„è¯„ä¼°</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter10/chapter10_part2.html">10.1 ç»ƒä¹ </a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">11. Logistic Regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter11/chapter11_part1.html">11.0 è´å¶æ–¯é€»è¾‘å›å½’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter11/chapter11_part2.html">11.1 ç»ƒä¹ </a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">12. Hierarchical Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter12/chapter12_part1.html">12.0 å±‚çº§æ•°æ®ç»“æ„ä¸å®Œå…¨æ± åŒ–æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter12/chapter12_part2.html">12.1 éæ± åŒ–æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter12/chapter12_part3.html">12.2 éƒ¨åˆ†æ± åŒ–æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter12/chapter12_part4.html">12.3 å¼€æ”¾å¼ç»ƒä¹ </a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">13. Hierarchical Regression Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter13/chapter13_part1.html">13.0 æ™®é€šçº¿æ€§æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter13/chapter13_part2.html">13.1 å˜åŒ–æˆªè·æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter13/chapter13_part3.html">13.2 å˜åŒ–æ–œç‡æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter13/chapter13_part4.html">13.3 å˜åŒ–æˆªè·å’Œæ–œç‡æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter13/chapter13_part5.html">13.4 åˆ†å±‚æ¨¡å‹ä¸­çš„ç»„å±‚é¢é¢„æµ‹å› å­</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter13/chapter13_part6.html">13.5 ç»ƒä¹ </a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">14. è¯¾ç¨‹å›é¡¾ä¸å¤ä¹ </span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter14/chapter14.html">14.0 è¯¾ç¨‹å›é¡¾ä¸å¤ä¹ </a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hcp4715/PyBayesianBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hcp4715/PyBayesianBook/issues/new?title=Issue%20on%20page%20%2Fchapter4/chapter4_part2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter4/chapter4_part2.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>4.1 Grid approximation ç½‘æ ¼è¿‘ä¼¼</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">4.1 Grid approximation ç½‘æ ¼è¿‘ä¼¼</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-beta-binomial-example">A Beta-Binomial example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">ç¤ºä¾‹ï¼šç½‘ç»œè¿‘ä¼¼ä¼°è®¡åéªŒåˆ†å¸ƒ</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step1">Step1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step2-3">Step2&amp;3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step4">Step4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">ç»ƒä¹ </a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">æ¨¡å‹è®¾å®š</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mu-sigma">å¢åŠ éš¾åº¦ï¼šä¼°è®¡<span class="math notranslate nohighlight">\(\mu\)</span> å’Œ <span class="math notranslate nohighlight">\(\sigma\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">ç½‘æ ¼è¿‘ä¼¼çš„å±€é™æ€§</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#markov-chain-monte-carlo-mcmc">Markov chain Monte Carlo(MCMC)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcmc">MCMC çš„é‡‡æ ·ç‰¹ç‚¹</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="grid-approximation">
<h1>4.1 Grid approximation ç½‘æ ¼è¿‘ä¼¼<a class="headerlink" href="#grid-approximation" title="Link to this heading">#</a></h1>
<p><img alt="alt text" src="../_images/image-46.png" /></p>
<blockquote>
<div><ul class="simple">
<li><p>æƒ³è±¡æœ‰ä¸€å¼ å›¾åƒ(å›¾ä¸‰)ï¼Œä½†ä½ ä¸èƒ½å®Œæ•´åœ°çœ‹åˆ°å®ƒã€‚ä¸è¿‡ä½ å¯ä»¥ä»å·¦åˆ°å³æ¯æ¬¡å–ä¸€ä¸ªè¿™ä¸ªå›¾åƒä¸­çš„ä¸€ä¸ªå°æ ¼æ¥è§‚å¯Ÿå®ƒã€‚</p></li>
<li><p>åªè¦æ ¼å­è¶Šç»†ï¼Œæœ€åç»„åˆåœ¨ä¸€èµ·å°±ä¼šä¸å®Œæ•´çš„å›¾ç‰‡æ›´è¿‘ä¼¼</p></li>
</ul>
</div></blockquote>
<p>åœ¨ç½‘æ ¼è¿‘ä¼¼ä¸­ï¼ŒåéªŒåˆ†å¸ƒ<span class="math notranslate nohighlight">\(f(Î¸|y)\)</span>å…¶å®å°±æ˜¯å®Œæ•´çš„å›¾ç‰‡ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æœ‰é™ä¸ª<span class="math notranslate nohighlight">\(Î¸\)</span>ï¼Œå¹¶è§‚å¯Ÿå¯¹åº”çš„<span class="math notranslate nohighlight">\(f(Î¸|y)\)</span>ï¼Œä»¥æ­¤æ¥è¿‘ä¼¼å®Œæ•´çš„åéªŒåˆ†å¸ƒã€‚</p>
<ul class="simple">
<li><p>ä»¥ä¸€ä¸ªå‚æ•°ä¸ºä¾‹ï¼Œç½‘ç»œè¿‘ä¼¼å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p></li>
</ul>
<p>1.é€‰å®šä¸€ç³»åˆ—ç¦»æ•£çš„<span class="math notranslate nohighlight">\(Î¸\)</span>å€¼</p>
<p>2.è®¡ç®—æ¯ä¸ª<span class="math notranslate nohighlight">\(Î¸\)</span>å€¼å¯¹åº”çš„å…ˆéªŒåˆ†å¸ƒ<span class="math notranslate nohighlight">\(f(Î¸)\)</span>å’Œä¼¼ç„¶å‡½æ•°<span class="math notranslate nohighlight">\(L(Î¸|y)\)</span></p>
<p>3.å¯¹äºæ‰€æœ‰çš„<span class="math notranslate nohighlight">\(Î¸\)</span>å€¼ï¼Œè®¡ç®—<span class="math notranslate nohighlight">\(f(Î¸)\)</span>å’Œ<span class="math notranslate nohighlight">\(L(Î¸|y)\)</span>äºŒè€…çš„ä¹˜ç§¯å¹¶ç›¸åŠ ï¼Œå†è¿›è¡Œå½’ä¸€åŒ–</p>
<p>4.å½’ä¸€åŒ–åï¼Œæ ¹æ®<span class="math notranslate nohighlight">\(Î¸\)</span>å€¼çš„åéªŒæ¦‚ç‡åˆ†å¸ƒï¼ŒéšæœºæŠ½å–Nä¸ª<span class="math notranslate nohighlight">\(Î¸\)</span>å€¼</p>
<section id="a-beta-binomial-example">
<h2>A Beta-Binomial example<a class="headerlink" href="#a-beta-binomial-example" title="Link to this heading">#</a></h2>
<p>å‡è®¾å…ˆéªŒ<span class="math notranslate nohighlight">\(\pi\)</span>æœä»Betaåˆ†å¸ƒï¼š</p>
<div class="math notranslate nohighlight">
\[
\pi \sim Beta(\alpha=70,\beta=30)
\]</div>
<p>ä¼¼ç„¶å‡½æ•°ï¼š</p>
<div class="math notranslate nohighlight">
\[
Y|\pi \sim Bin(n,\pi)
\]</div>
<ul class="simple">
<li><p>å‡è®¾<span class="math notranslate nohighlight">\(\pi\)</span>åæ˜ çš„æ˜¯æ­£ç¡®ç‡ï¼Œä¼¼ç„¶å‡½æ•°åæ˜ çš„åˆ™æ˜¯åœ¨æŸä¸ªæ­£ç¡®ç‡ä¸‹ï¼Œæ€»trialä¸º100æ¬¡æ—¶ï¼Œæ­£ç¡®æ¬¡æ•°çš„åˆ†å¸ƒæ¦‚ç‡æƒ…å†µã€‚</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\pi \sim \text{Beta}(70, 30)
\]</div>
<div class="math notranslate nohighlight">
\[
Y|\pi \sim \text{Bin}(100, \pi)
\]</div>
<ul class="simple">
<li><p>åœ¨è§‚å¯Ÿåˆ°<span class="math notranslate nohighlight">\(n\)</span>æ¬¡äº‹ä»¶ä¸­æœ‰<span class="math notranslate nohighlight">\(Y=y\)</span>æ¬¡ç›®æ ‡äº‹ä»¶åï¼Œ<span class="math notranslate nohighlight">\(\pi\)</span>çš„åéªŒåˆ†å¸ƒå¯ä»¥ç”¨<span class="math notranslate nohighlight">\(Beta\)</span>æ¨¡å‹æ¥æè¿°ï¼Œåæ˜ äº†å…ˆéªŒ<span class="math notranslate nohighlight">\(ï¼ˆé€šè¿‡\alphaå’Œ\betaï¼‰\)</span>å’Œæ•°æ®<span class="math notranslate nohighlight">\((é€šè¿‡yå’Œn)\)</span>çš„å½±å“ï¼š</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\pi | (Y = y) \sim \text{Beta}(\alpha + y, \beta + n - y)
\]</div>
<ul class="simple">
<li><p>å‡è®¾æ­£ç¡®æ¬¡æ•°ä¸º90ï¼Œæˆ‘ä»¬é€šè¿‡å…±è½­å…ˆéªŒçš„å…¬å¼ï¼Œå¯ä»¥ç›´æ¥è®¡ç®—å‡º<span class="math notranslate nohighlight">\(Beta\)</span>åéªŒåˆ†å¸ƒçš„ä¸¤ä¸ªå‚æ•°ï¼š</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
Y+\alpha=90+70, \beta+n-Y=30+100-90
\]</div>
<div class="math notranslate nohighlight">
\[
\pi|(Y=90)\sim Beta(160,40)
\]</div>
<p>è¿™ä¸ªç»“æœå¯ä»¥ç”¨æ¥å¯¹æˆ‘ä»¬ä½¿ç”¨ç½‘ç»œè¿‘ä¼¼çš„åéªŒè¿›è¡ŒéªŒè¯ã€‚</p>
</section>
<section id="id1">
<h2>ç¤ºä¾‹ï¼šç½‘ç»œè¿‘ä¼¼ä¼°è®¡åéªŒåˆ†å¸ƒ<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<section id="step1">
<h3>Step1<a class="headerlink" href="#step1" title="Link to this heading">#</a></h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåœ¨0.5åˆ°1è¿™ä¸ªåŒºé—´å†…å–ä¸€ç³»åˆ—çš„å€¼ï¼Œæ€»å…±å–11ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯æ¯éš”0.05å–ä¸€ä¸ªã€‚</p>
<div class="math notranslate nohighlight">
\[
\pi \in {0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95,1}
\]</div>
<p>å¯¼å…¥éœ€è¦çš„åŒ…ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
<p>ä»0.5åˆ°1ä¹‹é—´å–å‡º11ä¸ªå€¼ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pi_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ä»0.5~1å†…çš„è¿ç»­å˜é‡Ï€ä¸­å–å‡º11ä¸ªå€¼:&quot;</span><span class="p">,</span> <span class="n">pi_grid</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step2-3">
<h3>Step2&amp;3<a class="headerlink" href="#step2-3" title="Link to this heading">#</a></h3>
<p>åœ¨æ¯ä¸€ä¸ª<span class="math notranslate nohighlight">\(\pi\)</span>ä¸‹ï¼Œè®¡ç®—å…ˆéªŒåˆ†å¸ƒ<span class="math notranslate nohighlight">\(Beta(70,30)\)</span>ï¼Œä¸ä¼¼ç„¶å‡½æ•°<span class="math notranslate nohighlight">\(Bin(100,\pi)(Y=90)\)</span>çš„ä¹˜ç§¯ï¼Œè®¡ç®—æ€»å’Œå¹¶è¿›è¡Œå½’ä¸€åŒ–ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prior</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">pi_grid</span><span class="p">)</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">prior</span> <span class="o">*</span> <span class="n">likelihood</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prior</span> <span class="o">*</span> <span class="n">likelihood</span><span class="p">)</span>
</pre></div>
</div>
<p>æˆ‘ä»¬å°†åéªŒåˆ†å¸ƒå¯è§†åŒ–å‡ºæ¥ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ä½¿ç”¨ plt.stem() ç»˜åˆ¶å‚ç›´æŸ±çŠ¶å›¾ï¼Œè¡¨ç¤ºåœ¨ pi_grid ä¸Šçš„ posterior åˆ†å¸ƒ</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span>
    <span class="n">pi_grid</span><span class="p">,</span>
    <span class="n">posterior</span><span class="p">,</span>  
    <span class="n">linefmt</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">bottom</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># è®¾ç½® y è½´èŒƒå›´åœ¨ 0 åˆ° 1 ä¹‹é—´</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;pi_grid&quot;</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Posterior&quot;</span><span class="p">)</span>  
<span class="c1"># å»é™¤å›¾å½¢çš„ä¸Šæ–¹å’Œå³ä¾§çš„è¾¹æ¡†</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
<center><img width = '450' height ='300' src="image-5.png">
</center>
<p>å›¾ä¸­æ¯ä¸ªé»‘ç‚¹å°±æ˜¯<span class="math notranslate nohighlight">\(\pi\)</span>çš„å–å€¼ï¼Œåˆ†åˆ«è®¡ç®—å‡ºåéªŒæ¦‚ç‡ï¼Œå¯¹ä»–è¿›è¡Œå½’ä¸€åŒ–ï¼Œæœ€åå°±å¾—åˆ°äº†åéªŒåˆ†å¸ƒã€‚ä½†è¿™ä¸ªåˆ†åˆ«å’Œæˆ‘ä»¬çœŸæ­£çš„åéªŒåˆ†å¸ƒè¿˜å·®çš„å¾ˆå¤šï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œå¯è§†åŒ–ã€‚</p>
</section>
<section id="step4">
<h3>Step4<a class="headerlink" href="#step4" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>å¾—åˆ°åéªŒç»“æœ<span class="math notranslate nohighlight">\((Ï€)\)</span>çš„åˆ†å¸ƒåï¼Œä»è¿™ä¸ªåˆ†å¸ƒä¸­æŠ½æ ·10000æ¬¡ï¼Œå¯¹åéªŒè¿›è¡Œå¯è§†åŒ–ã€‚</p></li>
</ul>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œ<span class="math notranslate nohighlight">\(\pi=0.8\)</span>çš„åéªŒæ¦‚ç‡æ˜¾è‘—é«˜äºå…¶ä»–ç‚¹ï¼Œæ‰€ä»¥å¤§å¤šæ•°æ ·æœ¬ä¼šé›†ä¸­åœ¨<span class="math notranslate nohighlight">\(\pi=0.8\)</span>é™„è¿‘ã€‚</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">84735</span><span class="p">)</span>

<span class="c1">#  ä» posterior åˆ†å¸ƒä¸­æŠ½å– 10000 ä¸ªæ ·æœ¬</span>
<span class="n">posterior_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
    <span class="n">pi_grid</span><span class="p">,</span> 
    <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">p</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span>  
    <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># å°†æŠ½å–çš„æ ·æœ¬å­˜å‚¨åœ¨ DataFrame ä¸­ï¼Œåˆ—åä¸º &quot;pi_sample&quot;</span>
<span class="n">posterior_sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;pi_sample&quot;</span><span class="p">:</span> <span class="n">posterior_sample</span><span class="p">}</span>
<span class="p">)</span>  

<span class="c1"># å¯¹ posterior_sample ä¸­çš„æ ·æœ¬è¿›è¡Œè®¡æ•°ï¼Œå¹¶ä½¿ç”¨ normalize=True å°†è®¡æ•°è½¬æ¢ä¸ºç›¸å¯¹é¢‘ç‡</span>
<span class="n">posterior_sample</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span>
    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="alt text" src="../_images/image-66.png" /></p>
<p><strong>æŠ½æ ·ç»“æœå›¾ç¤º</strong></p>
<p>æŠ½æ ·ç»“æœæ˜¾ç¤ºï¼Œ<span class="math notranslate nohighlight">\(Ï€\)</span>å¤§å¤šæ•°é›†ä¸­åœ¨ 0.80 é™„è¿‘ï¼Œå°‘éƒ¨åˆ†åœ¨ 0.75 å’Œ 0.85 é™„è¿‘ã€‚</p>
<ul class="simple">
<li><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŠ½æ ·å¾—åˆ°çš„åéªŒåˆ†å¸ƒä¸ç†è®ºä¸Šçš„<span class="math notranslate nohighlight">\(Beta\)</span>åˆ†å¸ƒ<span class="math notranslate nohighlight">\(Beta(160,40)\)</span>è¿›è¡Œå¯¹æ¯”ï¼Œä»¥æ£€éªŒæŠ½æ ·çš„å‡†ç¡®æ€§ã€‚</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x_beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>  <span class="c1"># ç”Ÿæˆ10000 ä¸ªç‚¹ï¼ŒèŒƒå›´åœ¨ [0, 1] ä¹‹é—´</span>

<span class="n">y_beta</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_beta</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  <span class="c1"># ç”Ÿæˆ Beta(160,40)</span>

<span class="c1"># ç»˜åˆ¶å…±è½­æ–¹æ³•è®¡ç®—å¾—åˆ°çš„åéªŒ beta(160,40)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_beta</span><span class="p">,</span> <span class="n">y_beta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior of conjucated distribution&quot;</span><span class="p">)</span> 

<span class="c1"># ç»˜åˆ¶ç½‘æ ¼æ–¹æ³•æŠ½æ ·åå¾—åˆ°çš„ç»“æœ</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">posterior_sample</span><span class="p">[</span><span class="s2">&quot;pi_sample&quot;</span><span class="p">],</span>  
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;posterior of grid search&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="alt text" src="../_images/image-75.png" /></p>
<p>è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œç½‘ç»œè¿‘ä¼¼å¾—åˆ°çš„åéªŒåˆ†å¸ƒä¸<span class="math notranslate nohighlight">\(Beta(160,40)\)</span>å…·æœ‰å‡ åˆ†ç›¸ä¼¼ï¼Œä½†ç”±äºå–å€¼è¾ƒå°‘ï¼Œå½¢çŠ¶ä¸Šè¿˜å·®çš„è¾ƒå¤šï¼Œå› æ­¤æˆ‘ä»¬å¢å¤§å–å€¼çš„ä¸ªæ•°ã€‚</p>
<p><strong>å¢åŠ ç½‘æ ¼æ•°</strong></p>
<ul class="simple">
<li><p>è¿™ä¸ªç»“æœå½“ç„¶è¿‡åº¦ç®€åŒ–äº†åéªŒåˆ†å¸ƒï¼Œè¿˜è®°å¾—æˆ‘ä»¬åˆšåˆšæåˆ°ï¼Œåªè¦å–çš„ç½‘æ ¼è¶Šå¤šï¼Œå¯¹åéªŒçš„ä¼°è®¡ä¼šæ›´å‡†ç¡®ã€‚</p></li>
<li><p>é‚£ä¹ˆï¼Œç°åœ¨<span class="math notranslate nohighlight">\(\pi\)</span>ä¸å–11ä¸ªå€¼ï¼Œè€Œæ˜¯åœ¨0~1ä¹‹é—´å–101ä¸ªå€¼(æ¯éš”0.01å–1ä¸ª)</p></li>
<li><p>åŒæ ·ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸Šè¿°4ä¸ªæ­¥éª¤ï¼š</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ç”Ÿæˆä¸€ä¸ª 101 ä¸ªç‚¹ï¼ŒèŒƒå›´åœ¨ [0, 1] ä¹‹é—´</span>
<span class="n">pi_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>  
<span class="c1"># ç”Ÿæˆ Beta(70,30)</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>  

<span class="c1"># ç”ŸæˆäºŒé¡¹åˆ†å¸ƒ, å‚æ•°ä¸º n=100ï¼ˆæ€»è¯•éªŒæ¬¡æ•°ï¼‰ï¼Œk=90ï¼ˆæ­£ç¡®æ¬¡æ•°ï¼‰ï¼Œä»¥åŠ pi_grid ä¸­çš„æ¯ä¸ªæ¦‚ç‡å€¼</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span>
    <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">pi_grid</span>
<span class="p">)</span>  

<span class="c1"># è®¡ç®—åéªŒæ¦‚ç‡ï¼Œå³å…ˆéªŒæ¦‚ç‡å’Œä¼¼ç„¶å‡½æ•°çš„ä¹˜ç§¯ï¼Œç„¶åé™¤ä»¥å½’ä¸€åŒ–å¸¸æ•°ï¼ˆåˆ†æ¯å’Œï¼‰</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">prior</span> <span class="o">*</span> <span class="n">likelihood</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prior</span> <span class="o">*</span> <span class="n">likelihood</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ç”»å›¾</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="alt text" src="../_images/image-85.png" /></p>
<p>å…¶å®æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠlikelihoodçš„æ•°é‡å¢åŠ å³å¯ï¼Œç”šè‡³å¯ä»¥å¢åŠ åˆ°1001ä¸ª<span class="math notranslate nohighlight">\(\pi\)</span>å€¼ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™æ¬¡çš„å–æ ·ä¸­ï¼Œ<span class="math notranslate nohighlight">\(\pi\)</span>çš„å–å€¼æ›´åŠ å¤šæ ·ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå’Œä¸Šé¢çš„æ­¥éª¤ä¸€æ ·ï¼Œä»åéªŒä¸­æŠ½å–10000ä¸ªæ ·æœ¬å½¢æˆåéªŒåˆ†å¸ƒï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">84735</span><span class="p">)</span>

<span class="c1"># ä» posterior åˆ†å¸ƒä¸­æŠ½å– 10000 ä¸ªæ ·æœ¬</span>
<span class="n">posterior_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
    <span class="n">pi_grid</span><span class="p">,</span>  
    <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>  
    <span class="n">p</span><span class="o">=</span><span class="n">posterior</span><span class="p">,</span>  
    <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>  

<span class="c1"># å°†æŠ½å–çš„æ ·æœ¬å­˜å‚¨åœ¨ DataFrame ä¸­ï¼Œåˆ—åä¸º &quot;pi_sample&quot;</span>
<span class="n">posterior_sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;pi_sample&quot;</span><span class="p">:</span> <span class="n">posterior_sample</span><span class="p">}</span>
<span class="p">)</span>  

<span class="c1"># å¯¹ posterior_sample ä¸­çš„æ ·æœ¬è¿›è¡Œè®¡æ•°ï¼Œå¹¶ä½¿ç”¨ normalize=True å°†è®¡æ•°è½¬æ¢ä¸ºç›¸å¯¹é¢‘ç‡</span>
<span class="n">posterior_sample</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span>
    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>æŠ½æ ·ç»“æœå›¾ç¤º</strong></p>
<p>å¯¹æ¯”ä¸€ä¸‹æŠ½æ ·å¾—åˆ°çš„åéªŒåˆ†å¸ƒå›¾ å’Œ å®é™…çš„åéªŒåˆ†å¸ƒ<span class="math notranslate nohighlight">\(Beta(110,30)\)</span></p>
<p>ç›¸æ¯”äºä¸Šä¸€æ¬¡ï¼Œè¿™ä¸€æ¬¡çš„ç»“æœæ›´åŠ æ¥è¿‘çœŸå®çš„åéªŒåˆ†å¸ƒ</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ç”Ÿæˆä¸€ä¸ª 10000 ä¸ªç‚¹ï¼ŒèŒƒå›´åœ¨ [0, 1] ä¹‹é—´</span>
<span class="n">x_beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="c1"># ç”ŸæˆBeta(160,40)  </span>
<span class="n">y_beta</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_beta</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>  

<span class="c1"># ç»˜åˆ¶å…±è½­æ–¹æ³•è®¡ç®—å¾—åˆ°çš„åéªŒ beta(160,40)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_beta</span><span class="p">,</span> <span class="n">y_beta</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior of conjucated distribution&quot;</span><span class="p">)</span>  

<span class="c1"># ç»˜åˆ¶ç½‘æ ¼æ–¹æ³•æŠ½æ ·åå¾—åˆ°çš„ç»“æœ</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">posterior_sample</span><span class="p">[</span><span class="s2">&quot;pi_sample&quot;</span><span class="p">],</span>  
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;posterior of grid search&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="alt text" src="../_images/image-95.png" /></p>
<ul class="simple">
<li><p>å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œç½‘ç»œè¿‘ä¼¼è·å¾—çš„åéªŒåˆ†å¸ƒå·²ç»éå¸¸æ¥è¿‘å…±è½­åˆ†å¸ƒã€‚å¦‚æœç»§ç»­å¢å¤§ç½‘æ ¼æ•°ï¼Œé‚£ä¹ˆä¼šè¶Šæ¥è¶Šæ¥è¿‘ã€‚</p></li>
</ul>
</section>
</section>
<section id="id2">
<h2>ç»ƒä¹ <a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>ğŸ“ƒä»¥Normal-Normalæ¨¡å‹ä¸ºä¾‹æ¥ç»ƒä¹ ç½‘æ ¼è¿‘ä¼¼</p>
</div></blockquote>
<p>åœ¨ Normal-Normal æ¨¡å‹ ä¸­ï¼Œè§‚æµ‹æ•°æ®å’Œå‚æ•°ä¹‹é—´çš„å…³ç³»æ˜¯é€šè¿‡æ­£æ€åˆ†å¸ƒæ¥è¡¨ç¤ºçš„ã€‚</p>
<section id="id3">
<h3>æ¨¡å‹è®¾å®š<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>å‡è®¾<span class="math notranslate nohighlight">\(\mu\)</span>æ˜¯å‚ä¸è€…åœ¨éšæœºç‚¹è¿åŠ¨ä»»åŠ¡ä¸­çš„å¹³å‡ååº”æ—¶é—´ï¼ˆå•ä½ï¼šmsï¼‰,<span class="math notranslate nohighlight">\(\sigma\)</span>æ˜¯å‚ä¸è€…åœ¨éšæœºç‚¹è¿åŠ¨ä»»åŠ¡ä¸­çš„æ ‡å‡†å·®ï¼ˆå•ä½ï¼šmsï¼‰ã€‚</p></li>
<li><p>å…ˆéªŒåˆ†å¸ƒè®¾ä¸ºæ­£æ€åˆ†å¸ƒï¼Œæˆ‘ä»¬å‡è®¾å‚ä¸è€…çš„å¹³å‡ååº”æ—¶é—´çº¦ä¸º 500 msï¼Œæ ‡å‡†å·®ä¸º 100 msã€‚</p></li>
</ul>
<blockquote>
<div><p>å¯¹äº<span class="math notranslate nohighlight">\(\mu\)</span>ï¼Œå…¶å…ˆéªŒåˆ†å¸ƒä¸º<span class="math notranslate nohighlight">\(\mu \sim Normal(500,200)\)</span>
å¯¹äº<span class="math notranslate nohighlight">\(\sigma\)</span>ï¼Œå…¶å…ˆéªŒåˆ†å¸ƒä¸º<span class="math notranslate nohighlight">\(\sigma \sim Normal(100,50)\)</span></p>
</div></blockquote>
<ul class="simple">
<li><p>è§‚æµ‹æ•°æ®<span class="math notranslate nohighlight">\(Y\)</span>è¡¨ç¤ºå‚ä¸è€…åœ¨å®éªŒä¸­å®é™…çš„ååº”æ—¶ã€‚å‡è®¾æˆ‘ä»¬æ”¶é›†äº†è¢«è¯•å®Œæˆ 10 æ¬¡å®éªŒçš„ååº”æ—¶ã€‚</p></li>
<li><p>ä¾‹å¦‚ [691., 582., 628., 729., 699., 472., 626., 538., 542., 583.] msã€‚</p></li>
</ul>
<p>ç›®æ ‡ï¼šé€šè¿‡ç½‘ç»œè¿‘ä¼¼æ³•è®¡ç®—<span class="math notranslate nohighlight">\(\mu\)</span>çš„åéªŒåˆ†å¸ƒã€‚</p>
<div class="math notranslate nohighlight">
\[
Y_i|\mu \stackrel{ind}{\sim} Normal(\mu,\sigma^2)
\]</div>
<div class="math notranslate nohighlight">
\[
\mu \sim Normal(\mu_0,\sigma^2_0)
\]</div>
<div class="math notranslate nohighlight">
\[
\sigma \sim Normal(\mu_1,\sigma^2_1)
\]</div>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä»…è€ƒè™‘åªæœ‰ä¸€ç§å‚æ•°çš„æƒ…å†µã€‚ å³å‡è®¾æˆ‘ä»¬å·²çŸ¥<span class="math notranslate nohighlight">\(\sigma\)</span>ä¸º80ï¼Œè€Œ<span class="math notranslate nohighlight">\(\mu\)</span>æœªçŸ¥ã€‚</p>
<p><span class="math notranslate nohighlight">\(\mu\)</span>çš„å…ˆéªŒä¸ºæ­£æ€åˆ†å¸ƒï¼Œå³<span class="math notranslate nohighlight">\(N(500,200)\)</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>ä»£ç è§£é‡Šï¼šnumpyä¸€èˆ¬ç”¨äºæ•°å€¼è®¡ç®—æˆ–è€…çŸ©é˜µç›¸å…³çš„è®¡ç®—ï¼›ståŒ…ä¸»è¦ç”¨æ¥åšä¸€äº›ç»Ÿè®¡åˆ†æï¼›pltåˆ™æ˜¯ç”¨æ¥ç»˜å›¾çš„åŒ…ã€‚
np.random.seed(0)åˆ™æ˜¯è®¾ç½®ä¸€ä¸ªéšæœºç§å­ï¼Œç¡®ä¿åç»­æ ¹æ®è¿™ä¸€seedè¿›è¡Œå¤åˆ¶ã€‚
æ¥ä¸‹æ¥ï¼Œç”Ÿæˆäº†ä¸€ä¸ªæ¨¡æ‹Ÿæ•°æ®dataï¼Œloc=550ä»£è¡¨å‡å€¼ä¸º550ï¼Œscale=80ä»£è¡¨æ ‡å‡†å·®ä¸º80ï¼Œsize=10ä»£è¡¨ç”Ÿæˆä¸€ä¸ªåŒ…å«10ä¸ªå…ƒç´ çš„æ•°ç»„ã€‚</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># å±•ç¤ºæ•°æ®</span>
<span class="n">data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>è¾“å‡ºï¼šarray([691., 582., 628., 729., 699., 472., 626., 538., 542., 583.])</p>
<blockquote>
<div><p>è¿™é‡Œçš„round()æ˜¯æŒ‡ä¿ç•™å°æ•°ç‚¹çš„å‡ ä½ï¼Œï¼ˆ0ï¼‰å°±æ˜¯æŒ‡æ•´æ•°</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¾ç½®ç½‘æ ¼èŒƒå›´å’Œæ­¥é•¿</span>
<span class="c1">#                            1. å‡è®¾è¢«è¯•ååº”çš„ååº”æ—¶èŒƒå›´ä¸º 200 åˆ° 800 ms</span>
<span class="c1">#                            2. è®¾å®šç½‘æ ¼æ­¥é•¿ä¸º10 (åç»­å¯ä»¥ä¿®æ”¹ä¸º20,50,100ç­‰)</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># mu_grid = np.linspace(..., ..., 20)</span>
</pre></div>
</div>
<blockquote>
<div><p>è¿™ä¸ªmu_gridå°±æ˜¯ä¸€ä¸ªåœ¨ä¸‹é™200ä¸Šé™800çš„èŒƒå›´å†…åŒ…å«äº†20ä¸ªæ•°çš„æ•°ç»„ï¼Œæ˜¯ä¸€ä¸ªä¸€ç»´çš„æ•°æ®ã€‚</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—å…ˆéªŒæ¦‚ç‡</span>
<span class="c1">#                            1. è®¾å®šå…ˆéªŒæ¦‚ç‡æœä»æ­£æ€åˆ†å¸ƒ</span>
<span class="c1">#                            2. å…ˆéªŒå‡å€¼ä¸º500, æ ‡å‡†å·®ä¸º100</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># prior_mean = ... </span>
<span class="c1"># prior_std = ...</span>
</pre></div>
</div>
<blockquote>
<div><p>æˆ‘ä»¬ä¹‹å‰å‡è®¾å…ˆéªŒæ¦‚ç‡æ˜¯æœä»æ­£æ€åˆ†å¸ƒçš„ï¼Œå› æ­¤è¿™é‡Œçš„å‡å€¼å¡«500ï¼Œæ ‡å‡†å·®å¡«100ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¦è®¡ç®—å…ˆéªŒåˆ†å¸ƒçš„æ¦‚ç‡ï¼Œåº”å½“ä¸ºï¼šprior_prob = st.norm.pdf(mu_grid, loc=prior_mean, scale=prior_std)</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—ä¼¼ç„¶å‡½æ•°</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># likelihood = ...</span>
</pre></div>
</div>
<blockquote>
<div><p>é¦–å…ˆï¼Œä¼¼ç„¶å‡½æ•°æ˜¯å¯¹æ¯ä¸€ä¸ªè§‚æµ‹æ•°æ®çš„å¯èƒ½æ€§ï¼Œå‰é¢çš„ç½‘æ ¼ä¸ªæ•°ä¸æ­¢ä¸€ä¸ªå€¼ï¼Œå®ƒæ˜¯å¾ˆå¤šä¸ªå€¼ä¸€èµ·çš„è”åˆæ¦‚ç‡ï¼Œå› æ­¤è¿™é‡Œçš„forå¾ªç¯ç›¸å½“äºä»mu_gridä¸­æŠ½å‡ºæ¯ä¸€ä¸ª<span class="math notranslate nohighlight">\(\mu\)</span>ï¼Œæˆ‘ä»¬çš„likelihoodåº”å½“æ˜¯ï¼š
likelihood = np.array(
[np.prod(st.norm.pdf(data, loc=mu, scale=80) for mu in mu_grid)]
)</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—åéªŒ</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># posterior_prob = ...</span>

<span class="c1"># å½’ä¸€åŒ–åéªŒæ¦‚ç‡</span>
</pre></div>
</div>
<blockquote>
<div><p>åéªŒåº”å½“æ˜¯ï¼šposterior_prob = prior_prob * likelihood
å½’ä¸€åŒ–åéªŒæ¦‚ç‡ï¼šposterior_prob /=np.sum(posterior_prob)</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—æ‰¾åˆ°åéªŒæ¦‚ç‡çš„æœ€å¤§å€¼å¯¹åº”çš„å‚æ•°</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># max_posterior = ...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;æœ€å¤§åéªŒæ¦‚ç‡å¯¹åº”çš„å‚æ•°å€¼ï¼š&quot;</span><span class="p">,</span> <span class="n">theta_grid</span><span class="p">[</span><span class="n">max_posterior</span><span class="p">])</span>
</pre></div>
</div>
<blockquote>
<div><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨np.argmax()ï¼Œå®ƒèƒ½å¤Ÿç”¨äºæ‰¾åˆ°æ•°ç»„ä¸­æœ€å¤§å€¼çš„ä¸€ä¸ªç´¢å¼•ä½ç½®ã€‚
å› æ­¤ï¼Œåº”å½“æ˜¯ï¼šmax_posterior = np.argmax(posterior_prob)</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ç»˜åˆ¶ç»“æœ</span>
<span class="c1">#plt.plot(x,y)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mu_grid</span><span class="p">,</span> <span class="n">prior_prob</span> <span class="o">/</span> <span class="n">prior_prob</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prior&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mu_grid</span><span class="p">,</span> <span class="n">posterior_prob</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior of grid method&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">posterior_prob</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;true data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Grid search posterior distribution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="alt text" src="../_images/image-105.png" /></p>
<blockquote>
<div><p>plt.vlinesæ˜¯ç»˜åˆ¶å‚ç›´çº¿ï¼Œxè½´å¯¹åº”çš„æ˜¯å‡å€¼ï¼Œæœ€ä½ç‚¹æ˜¯yè½´çš„0å€¼ï¼Œæœ€é«˜ç‚¹æ˜¯maxã€‚
plt.legendæ˜¯æŒ‡é›†ä¸­æ˜¾ç¤ºå›¾ä¾‹ï¼Œä¹Ÿå°±æ˜¯å·¦ä¸Šè§’çš„å°æ–¹å—ã€‚</p>
</div></blockquote>
<ul class="simple">
<li><p>é€šè¿‡è®¾ç½®ä¸åŒçš„ç½‘æ ¼æ•°ï¼Œå¤§å®¶å¯ä»¥è§‚å¯Ÿä¸€ä¸‹åéªŒåˆ†å¸ƒçš„å˜åŒ–ï¼Œä¾‹å¦‚å°†ç½‘æ ¼æ•°å¢åŠ åˆ°100ï¼Œ200ç­‰ç­‰ã€‚</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            é€šè¿‡å…±è½­æ–¹æ³•è®¡ç®—åéªŒæ¦‚ç‡ (å…·ä½“ç®—æ³•è§è¡¥å……ææ–™)</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">prior_mean</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">prior_variance</span> <span class="o">=</span> <span class="mi">200</span><span class="o">**</span><span class="mi">2</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mi">80</span><span class="o">**</span><span class="mi">2</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># è§‚æµ‹æ•°æ®çš„æ•°é‡</span>
<span class="n">posterior_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">prior_mean</span> <span class="o">/</span> <span class="n">prior_variance</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">sigma2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">prior_variance</span> <span class="o">+</span> <span class="n">n</span> <span class="o">/</span> <span class="n">sigma2</span><span class="p">)</span>
<span class="n">posterior_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">prior_variance</span> <span class="o">+</span> <span class="n">n</span> <span class="o">/</span> <span class="n">sigma2</span><span class="p">)</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">posterior_conjucate</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">posterior_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">posterior_std</span><span class="p">)</span>

<span class="c1"># ç»˜åˆ¶ç»“æœ</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">posterior_conjucate</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior of conjucated method&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">posterior_conjucate</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;true data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Conjucated posterior distribution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="mu-sigma">
<h3>å¢åŠ éš¾åº¦ï¼šä¼°è®¡<span class="math notranslate nohighlight">\(\mu\)</span> å’Œ <span class="math notranslate nohighlight">\(\sigma\)</span><a class="headerlink" href="#mu-sigma" title="Link to this heading">#</a></h3>
<p>ä¸Šé¢åªè€ƒè™‘äº†ä¼°è®¡<span class="math notranslate nohighlight">\(\mu\)</span>å‚æ•°ï¼Œä¸‹é¢æˆ‘ä»¬å¢åŠ éš¾åº¦ï¼Œå¢åŠ è€ƒè™‘ä¼°è®¡<span class="math notranslate nohighlight">\(\sigma\)</span>å‚æ•°ã€‚</p>
<p>æˆ‘ä»¬å‡è®¾<span class="math notranslate nohighlight">\(\mu\)</span>å’Œ<span class="math notranslate nohighlight">\(\sigma\)</span>çš„å…ˆéªŒæœä»æ­£æ€åˆ†å¸ƒï¼Œå³ï¼š</p>
<ul class="simple">
<li><p>å¯¹äº<span class="math notranslate nohighlight">\(\mu\)</span>ï¼Œå…¶å…ˆéªŒåˆ†å¸ƒä¸º<span class="math notranslate nohighlight">\(\mu \sim Normal(500,200)\)</span></p></li>
<li><p>å¯¹äº<span class="math notranslate nohighlight">\(\sigma\)</span>ï¼Œå…¶å…ˆéªŒåˆ†å¸ƒä¸º<span class="math notranslate nohighlight">\(\sigma \sim Normal(100,50)\)</span></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¾ç½®ç½‘æ ¼èŒƒå›´å’Œæ­¥é•¿</span>
<span class="c1">#                            1. å‡è®¾è¢«è¯•ååº”çš„ååº”æ—¶èŒƒå›´ä¸º 200 åˆ° 800 ms</span>
<span class="c1">#                            2. å‡è®¾è¢«è¯•ååº”æ—¶çš„æ–¹å·®èŒƒå›´ä¸º 20 åˆ° 200</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="n">n_step</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># mean_grid = ...  è¯·è¡¥å……...</span>
<span class="c1"># std_grid = ...   è¯·è¡¥å……...</span>

<span class="n">mean_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="n">n_step</span><span class="p">)</span>
<span class="n">std_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">n_step</span><span class="p">)</span>
<span class="n">mean_mesh</span><span class="p">,</span> <span class="n">std_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">mean_grid</span><span class="p">,</span> <span class="n">std_grid</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>ç”±äºæˆ‘ä»¬ç°åœ¨è¦ä¼°è®¡ä¸¤ä¸ªå‚æ•°ï¼Œå› æ­¤éœ€è¦åˆ©ç”¨np.meshgrid()ç”Ÿæˆä¸€ä¸ªäºŒç»´åæ ‡çŸ©é˜µã€‚</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—å…ˆéªŒæ¦‚ç‡</span>
<span class="c1">#                            1. è®¾å®šå…ˆéªŒæ¦‚ç‡æœä»æ­£æ€åˆ†å¸ƒ</span>
<span class="c1">#                            2. å…ˆéªŒå‡å€¼ä¸º500ï¼Œæ ‡å‡†å·®ä¸º100</span>
<span class="c1"># ---------------------------------------------------------------------------</span>

<span class="c1"># prior_mean = ...        </span>
<span class="c1"># prior_std = ...         </span>
<span class="n">prior_mean_mean</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">prior_mean_std</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">prior_std_mean</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">prior_std_std</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">prior_mean</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mean_mesh</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">prior_mean_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">prior_mean_std</span><span class="p">)</span>
<span class="n">prior_std</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">std_mesh</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">prior_std_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">prior_std_std</span><span class="p">)</span>
<span class="n">prior_grid</span> <span class="o">=</span> <span class="n">prior_mean</span> <span class="o">*</span> <span class="n">prior_std</span>
<span class="c1"># æ˜¾ç¤º prior_grid çš„å½¢çŠ¶</span>
<span class="n">prior_grid</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—ä¼¼ç„¶å‡½æ•°</span>
<span class="c1">#                            1. å…ˆè®¡ç®—ä¸€ç§å‚æ•°æ¡ä»¶ä¸‹çš„ä¼¼ç„¶å€¼</span>
<span class="c1">#                            2. é€šè¿‡forå¾ªç¯è®¡ç®—æ‰€æœ‰å‚æ•°æ¡ä»¶ä¸‹çš„ä¼¼ç„¶å€¼ï¼Œå¹¶å‚¨å­˜åœ¨likelihood_gridä¸­</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># likelihood_single = ...</span>
<span class="c1"># likelihood_grid = np.zeros((n_step, n_step))</span>

<span class="c1">#å®šä¹‰ä¸€ä¸ªå…¨0çŸ©é˜µ</span>
<span class="n">likelihood_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_step</span><span class="p">,</span> <span class="n">n_step</span><span class="p">))</span>
<span class="k">for</span> <span class="n">mean_index</span><span class="p">,</span> <span class="n">mean</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mean_grid</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">std_index</span><span class="p">,</span> <span class="n">std</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">std_gird</span><span class="p">):</span>
    <span class="n">likelihood_i</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
    <span class="n">likelihood_grid</span><span class="p">[</span><span class="n">mean_index</span><span class="p">,</span> <span class="n">std_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">likelihood_i</span>

<span class="n">likelihood_grid</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—gridçš„åéªŒæ¦‚ç‡</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># posterior_grid = ...</span>

<span class="n">posterior_grid</span> <span class="o">/=</span> <span class="n">posterior_grid</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># å½’ä¸€åŒ–</span>

<span class="c1"># æ˜¾ç¤º posterior_grid çš„å½¢çŠ¶</span>
<span class="n">posterior_grid</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##---------------------------------------------------------------------------</span>
<span class="c1">#                            è®¡ç®—æ‰¾åˆ°åéªŒæ¦‚ç‡çš„æœ€å¤§å€¼å¯¹åº”çš„å‚æ•°</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># max_idx = ...</span>
<span class="c1"># estimated_mean = ...</span>
<span class="c1"># estimated_std = ...</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated Mean: </span><span class="si">{</span><span class="n">estimated_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated Standard Deviation: </span><span class="si">{</span><span class="n">estimated_std</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ç»˜åˆ¶åéªŒæ¦‚ç‡åˆ†å¸ƒå›¾</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">prior_mean_mean</span><span class="p">,</span> <span class="n">prior_std_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prior&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">estimated_mean</span><span class="p">,</span> <span class="n">estimated_std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;max_posterior&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Mean&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Standard Deviation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Posterior Distribution&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="id4">
<h2>ç½‘æ ¼è¿‘ä¼¼çš„å±€é™æ€§<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>ğŸ˜æˆ–è®¸ä½ ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œä¸Šè¿°æ¨¡å‹è¿˜æ˜¯åªæœ‰ä¸€åˆ°ä¿©ä¸ªå‚æ•°çš„æƒ…å†µ</p>
<p>å½“æ¨¡å‹çš„å‚æ•°è¶Šæ¥è¶Šå¤šæ—¶ï¼Œç½‘æ ¼è¿‘ä¼¼å°±ä¼šé‡åˆ°â€œç»´æ•°ç¾éš¾é—®é¢˜â€ï¼Œä¾‹å¦‚å½“å‚æ•°å¢åŠ åˆ°3ä¸ªã€4ä¸ªç”šè‡³æ›´å¤šã€‚</p>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç®€å•ç†è§£ä¸ºï¼š<strong>å½“æ¨¡å‹å‚æ•°è¶Šæ¥è¶Šå¤šæ—¶ï¼Œç½‘æ ¼è¿‘ä¼¼éœ€è¦çš„è®¡ç®—æˆæœ¬ä¹Ÿè¶Šæ¥è¶Šé«˜ã€‚</strong></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="markov-chain-monte-carlo-mcmc">
<h1>Markov chain Monte Carlo(MCMC)<a class="headerlink" href="#markov-chain-monte-carlo-mcmc" title="Link to this heading">#</a></h1>
<p>åœ¨è®¡ç®—å…·æœ‰å¤šä¸ªå‚æ•°çš„åéªŒåˆ†å¸ƒæ—¶ï¼Œæœ‰ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•å«åšé©¬å°”ç§‘å¤«é“¾è’™ç‰¹å¡æ´›(MCMC)ï¼Œå¯ä»¥ç”¨äºæ¨¡æ‹Ÿå’Œè¿‘ä¼¼åéªŒæ¦‚ç‡åˆ†å¸ƒã€‚</p>
<p><em><strong>Markov chain</strong></em></p>
<ul class="simple">
<li><p>å‰ä¸€ä¸ªMCä¸­çš„Markov æ¥æºäºä¸€ä¸ªä¿„å›½æ•°å­¦å®¶çš„åå­— Andrey Markovã€‚</p></li>
<li><p>ä»–ç ”ç©¶å¹¶æå‡ºä¸€ç§æ•°å­¦æ–¹æ³•ï¼Œè¢«å‘½åä¸ºé©¬å°”ç§‘å¤«é“¾ã€‚ç”¨äºæè¿°çŠ¶æ€ç©ºé—´ä¸­ç»è¿‡ä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„è½¬æ¢çš„éšæœºè¿‡ç¨‹ã€‚</p></li>
<li><p>è¯¥è¿‡ç¨‹è¦æ±‚å…·å¤‡ <strong>â€œæ— è®°å¿†æ€§â€</strong>ï¼Œå³ä¸‹ä¸€çŠ¶æ€çš„æ¦‚ç‡åˆ†å¸ƒåªèƒ½ç”±å½“å‰çŠ¶æ€å†³å®šï¼Œåœ¨æ—¶é—´åºåˆ—ä¸­å®ƒå‰é¢çš„äº‹ä»¶å‡ä¸ä¹‹æ— å…³ã€‚</p></li>
<li><p>é©¬å°”å¯å¤«é“¾åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­éå¸¸å¹¿æ³›ï¼Œä¾‹å¦‚åˆ†å±‚éšé©¬å°”å¯å¤«æ¨¡å‹HMM (Hidden Markov Model)å’Œå¡å°”æ›¼æ»¤æ³¢æ¨¡å‹ã€‚</p></li>
</ul>
<p><em><strong>Monte Carlo</strong></em></p>
<ul class="simple">
<li><p>è€Œåä¸€ä¸ªMC (Monte Carlo)åˆ™æ˜¯ä¸€ä¸ªèµŒåœºçš„åå­—ã€‚æ®è¯´æ¥è‡ªäº 20 ä¸–çºª 40 å¹´ä»£ç»å¯†æ ¸æ­¦å™¨é¡¹ç›®çš„ï¼Œå…¶ä¸­æ–¯å¦å°¼æ–¯æ‹‰å¤«-ä¹Œæ‹‰å§†ã€çº¦ç¿°-å†¯-è¯ºä¼Šæ›¼å’Œä»–ä»¬åœ¨æ´›æ–¯é˜¿æ‹‰è«æ–¯å›½å®¶å®éªŒå®¤çš„åˆä½œè€…ä½¿ç”¨é©¬å°”å¯å¤«é“¾æ¥æ¨¡æ‹Ÿå’Œæ›´å¥½åœ°ç†è§£ä¸­å­æ—…è¡Œç°è±¡ï¼ˆEckhardtï¼Œ1987ï¼‰ã€‚æ´›æ–¯é˜¿æ‹‰è«æ–¯å›¢é˜Ÿå°†ä»–ä»¬çš„å·¥ä½œç§°ä¸º â€œè’™ç‰¹å¡æ´›â€ï¼Œæ®è¯´è¿™ä¸€é€‰æ‹©æ˜¯å—åˆ°æ³•å›½é‡Œç»´åŸƒæ‹‰å¯Œä¸½å ‚çš‡çš„è’™ç‰¹å¡æ´›èµŒåœºçš„å¯å‘ã€‚</p></li>
</ul>
<section id="mcmc">
<h2>MCMC çš„é‡‡æ ·ç‰¹ç‚¹<a class="headerlink" href="#mcmc" title="Link to this heading">#</a></h2>
<p>1ã€å’Œç½‘æ ¼æ³•ç±»ä¼¼ï¼ŒMCMCå¹¶ä¸ä¼šä»åéªŒåˆ†å¸ƒ<span class="math notranslate nohighlight">\(f(\theta |y)\)</span>ä¸­ç›´æ¥é‡‡æ ·</p>
<p>2ã€å¹¶ä¸”åŒºåˆ†ä¸ç½‘æ ¼æ³•ï¼ŒMCMCçš„æ ·æœ¬ä¸æ˜¯äº’ç›¸ç‹¬ç«‹çš„â€”â€”ä¸‹ä¸€ä¸ªæ ·æœ¬å€¼ä¾èµ–äºä¸Šä¸€ä¸ªæ ·æœ¬å€¼</p>
<p><img alt="alt text" src="../_images/image-117.png" /></p>
<blockquote>
<div><p>source: <a class="reference external" href="https://zhuanlan.zhihu.com/p/250146007">https://zhuanlan.zhihu.com/p/250146007</a></p>
</div></blockquote>
<p>æ ¹æ®ä¸Šé¢è¿™ä¸ªå›¾ä¾‹ï¼ŒMCMCä¸»è¦è®²çš„æ˜¯å¦‚ä½•ä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚è™½ç„¶è¯´èµ·æ¥å¾ˆç®€å•ï¼Œä½†çŠ¶æ€å˜å¤šåï¼Œè½¬æ¢æ¬¡æ•°å˜å¤šåï¼Œæ“ä½œèµ·æ¥å°±ä¼šå¾ˆå¤æ‚ã€‚</p>
<p>å‡è®¾åéªŒåˆ†å¸ƒä»æ˜¯å…³äº<span class="math notranslate nohighlight">\(\theta\)</span>çš„åˆ†å¸ƒï¼Œ{<span class="math notranslate nohighlight">\(\theta^{(1)},\theta^{(2)},....\theta^{(N)}\)</span>}æ„æˆäº†ä¸€ä¸ªé•¿åº¦ä¸ºNçš„é©¬å°”ç§‘å¤«é“¾</p>
<ul class="simple">
<li><p>å…¶ä¸­ï¼Œ<span class="math notranslate nohighlight">\(\theta^{(2)}\)</span>çš„ç»“æœä¾èµ–äº<span class="math notranslate nohighlight">\(\theta^{(1)}\)</span>ï¼Œ<span class="math notranslate nohighlight">\(\theta^{(3)}\)</span>çš„ç»“æœåˆä¾èµ–äº<span class="math notranslate nohighlight">\(\theta^{(2)}\)</span>â€¦.</p></li>
<li><p>æ€»çš„æ¥è¯´ï¼Œ<span class="math notranslate nohighlight">\(\theta^{(i+1)}\)</span>çš„ç»“æœä¾èµ–äº<span class="math notranslate nohighlight">\(\theta^{(i)}\)</span>å’Œæ”¶é›†åˆ°çš„æ•°æ®y</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
f(\theta^{(i+1)}|\theta^{(1)},\theta^{(2)},...\theta^{(i)},y) = f(\theta^{(i+1)}|\theta^{(i)}, y)
\]</div>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\theta^{(i+1)}\)</span>ç‹¬ç«‹äº<span class="math notranslate nohighlight">\(\theta^{(i-1)}\)</span>ï¼Œè¿™å°±æ˜¯é©¬å°”ç§‘å¤«é“¾çš„â€œæ— è®°å¿†æ€§â€ç‰¹ç‚¹</p>
</div></blockquote>
<p><strong>å¥½æ¶ˆæ¯æ˜¯ï¼š</strong></p>
<ul class="simple">
<li><p>æˆ‘ä»¬æ— éœ€ä»é›¶å¼€å§‹ç¼–å†™è¿™äº›å¤æ‚çš„ç®—æ³•ã€‚ç›®å‰å·²ç»æœ‰ä¸å°‘é«˜æ•ˆçš„å·¥å…·ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬è½»æ¾å®ç°å¤æ‚çš„MCMCé‡‡æ ·çš„é—®é¢˜ï¼Œä»è€Œå¸®åŠ©æˆ‘ä»¬å®ç°å¤æ‚çš„è´å¶æ–¯æ¨¡å‹ã€‚</p></li>
</ul>
<p><strong>æ¦‚ç‡ç¼–ç¨‹è¯­è¨€ï¼š</strong></p>
<ul class="simple">
<li><p>è¿™äº›å·¥å…·è¢«ç»Ÿç§°ä¸ºæ¦‚ç‡ç¼–ç¨‹è¯­è¨€ï¼ˆProbability Programming Languagesï¼‰ï¼Œç®€ç§°PPLã€‚å®ƒä»¬åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç§ï¼š</p></li>
<li><p><a class="reference external" href="https://mc-stan.org/">stan</a></p></li>
<li><p><a class="reference external" href="https://www.pymc.io/welcome.html">PyMC</a></p></li>
<li><p><a class="reference external" href="https://sourceforge.net/projects/mcmc-jags/">JAGS</a></p></li>
<li><p><a class="reference external" href="http://www.bayesianscientific.org/resource/bugs-openbugs-winbugs/">BUGS (Bayesian Inference Using Gibbs Sampling)</a></p></li>
<li><p><a class="reference external" href="https://turinglang.org/docs/tutorials/docs-00-getting-started/index.html">julia turing</a></p></li>
</ul>
<p><strong>What is PyMC ?</strong></p>
<p><img alt="alt text" src="../_images/image-125.png" /></p>
<p>PyMCæ˜¯ä¸€ä¸ªåœ¨Pythonä¸­åŸºäº æ¦‚ç‡ç¼–ç¨‹è¯­éŸ³(probabilistic program language, PPL) çš„å·¥å…·ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨ç®€å•çš„Python APIæ„å»ºè´å¶æ–¯æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡æ´›ï¼ˆMCMCï¼‰æ–¹æ³•è¿›è¡Œæ‹Ÿåˆã€‚</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ul class="simple">
<li><p>PyMCè‡´åŠ›äºä½¿è´å¶æ–¯å»ºæ¨¡å°½å¯èƒ½ç®€å•ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿä¸“æ³¨äºé—®é¢˜æœ¬èº«ï¼Œè€Œä¸æ˜¯æ–¹æ³•ã€‚</p></li>
<li><p>åŒ…æ‹¬æœ€å…ˆè¿›çš„æ¨æ–­ç®—æ³•ï¼ŒåŒ…æ‹¬MCMCï¼ˆNUTSï¼‰å’Œå˜åˆ†æ¨æ–­ï¼ˆADVIï¼‰ã€‚</p></li>
<li><p>é«˜æ•ˆå¿«é€Ÿï¼šä½¿ç”¨PyTensorä½œä¸ºè®¡ç®—åç«¯ï¼Œé€šè¿‡Cã€Numbaæˆ–JAXè¿›è¡Œç¼–è¯‘ï¼Œå¯ä»¥å°†æ¨¡å‹è¿è¡Œåœ¨GPUä¸Šï¼Œå¹¶å—ç›Šäºå¤æ‚çš„å›¾ä¼˜åŒ–ã€‚</p></li>
<li><p>æä¾›åç»­çš„åˆ†ææ–¹æ³•ï¼šåŒ…æ‹¬æ¦‚ç‡åˆ†å¸ƒã€é«˜æ–¯è¿‡ç¨‹ã€ABCã€SMCç­‰ç­‰ã€‚å®ƒä¸ArviZé›†æˆå¾—å¾ˆå¥½ï¼Œç”¨äºå¯è§†åŒ–å’Œè¯Šæ–­ï¼Œä»¥åŠä¸Bambié›†æˆç”¨äºé«˜çº§æ··åˆæ•ˆåº”æ¨¡å‹ã€‚</p></li>
<li><p>æ³¨é‡ç¤¾åŒºï¼šåœ¨è®¨è®ºåŒºæé—®é—®é¢˜ï¼Œå‚åŠ MeetUpæ´»åŠ¨ï¼Œå…³æ³¨ä»–ä»¬çš„Twitterï¼Œå¹¶å¼€å§‹è´¡çŒ®ã€‚</p></li>
</ul>
<p><em><strong>è¯¾ç¨‹é¢„å‘Šï¼š</strong></em></p>
<p>åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡æ´›(MCMC) æ–¹æ³•çš„å…·ä½“åŸç†ã€‚MCMCæ˜¯ä¸€ç§å¼ºå¤§çš„ç»Ÿè®¡æ¨¡æ‹ŸæŠ€æœ¯ï¼Œç”¨äºä¼°è®¡è´å¶æ–¯æ¨¡å‹ä¸­çš„å‚æ•°ã€‚</p>
<p>æˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»å¦‚ä½•ä½¿ç”¨ PyMC è¿™ä¸€æ¦‚ç‡ç¼–ç¨‹è¯­è¨€æ¥è¿›è¡ŒMCMCæ¨¡æ‹Ÿçš„åŸºæœ¬è¿‡ç¨‹ã€‚é€šè¿‡PyMCï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°è¿›è¡Œè´å¶æ–¯ç»Ÿè®¡åˆ†æï¼Œæ— éœ€æ‹…å¿ƒåº•å±‚ç®—æ³•çš„å®ç°ç»†èŠ‚ã€‚</p>
<p><strong>ğŸ’è¡¥å……ææ–™</strong></p>
<p>Normal-Normal conjugate family
é™¤äº† Beta-Binomial å¤–ï¼Œæœ€å¸¸è§çš„å…±è½­åˆ†å¸ƒæ˜¯ï¼šNormal-Normalã€‚</p>
<ul class="simple">
<li><p>ä»¥éšæœºç‚¹è¿åŠ¨ä»»åŠ¡ï¼ˆRandom Dot Motion Taskï¼‰ä¸ºä¾‹</p></li>
</ul>
<p>å‡è®¾æˆ‘ä»¬æ‰“ç®—å¼€å§‹è¿›è¡Œä¸€é¡¹éšæœºç‚¹è¿åŠ¨ä»»åŠ¡å®éªŒï¼Œå°šæœªå¼€å§‹æ‹›å‹Ÿè¢«è¯•ã€‚ä¸ºäº†å¯¹è¢«è¯•åœ¨ä¸åŒæ¡ä»¶ä¸‹çš„è¡¨ç°è¿›è¡Œæ¨æ–­ï¼Œæˆ‘ä»¬å‚è€ƒäº†å…ˆå‰çš„æ–‡çŒ®Vafaei Shooshtari et al. (2019)ï¼Œä»–ä»¬çš„ç ”ç©¶è¡¨æ˜ï¼Œå½“éšæœºç‚¹çš„ä¸€è‡´æ€§ä¸º5%æ—¶ï¼Œä¸ªä½“çš„å¹³å‡æ­£ç¡®ç‡çº¦ä¸º 70%ã€‚</p>
<p>ä¸ºäº†æ›´æ–°æˆ‘ä»¬å¯¹è¢«è¯•åœ¨éšæœºç‚¹ä¸€è‡´æ€§ä¸º5%æ—¶çš„å¹³å‡æ­£ç¡®ç‡çš„ä¿¡å¿µï¼Œæˆ‘ä»¬è®¡åˆ’é€šè¿‡è´å¶æ–¯æ¨æ–­æ”¶é›†10000åè¢«è¯•çš„å®éªŒæ•°æ®ï¼Œå¹¶ä½¿ç”¨Normal-Normal è´å¶æ–¯æ¨¡å‹æ¥ä¼°è®¡æ›´æ–°åçš„æ­£ç¡®ç‡ã€‚</p>
<blockquote>
<div><p>Shooshtari, S. V., Sadrabadi, J. E., Azizi, Z., &amp; Ebrahimpour, R. (2019). Confidence representation of perceptual decision by EEG and eye data in a random dot motion task. Neuroscience, 406, 510â€“527. <a class="reference external" href="https://doi.org/10.1016/j.neuroscience.2019.03.031">https://doi.org/10.1016/j.neuroscience.2019.03.031</a></p>
</div></blockquote>
<p><strong>æ­£æ€æ¨¡å‹çš„åº”ç”¨</strong></p>
<p>åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬å‡è®¾è¢«è¯•çš„æ­£ç¡®ç‡æœä»æ­£æ€åˆ†å¸ƒï¼Œå³ï¼š</p>
<div class="math notranslate nohighlight">
\[
Y \sim N(\mu,\sigma^2)
\]</div>
<p>å…¶ä¸­ï¼š</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_i\)</span>æ˜¯ç¬¬iä¸ªè¢«è¯•åœ¨éšæœºç‚¹ä¸€è‡´æ€§ä¸º5%æ—¶çš„æ­£ç¡®ç‡</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu\)</span>æ˜¯æˆ‘ä»¬è¦ä¼°è®¡çš„å¹³å‡æ­£ç¡®ç‡</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span>æ˜¯å·²çŸ¥çš„æ­£ç¡®ç‡æ ‡å‡†å·®</p></li>
</ul>
<p>æ ¹æ® Vafaei Shooshtari et al. (2019) çš„ç ”ç©¶ç»“æœï¼Œæˆ‘ä»¬å¯¹<span class="math notranslate nohighlight">\(\mu\)</span>ï¼ˆå¹³å‡æ­£ç¡®ç‡ï¼‰çš„åˆå§‹ä¿¡å¿µå‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒï¼Œå³å…ˆéªŒåˆ†å¸ƒä¸ºï¼š</p>
<div class="math notranslate nohighlight">
\[
\mu \sim N(\theta, \tau^2)
\]</div>
<p>æ³¨ï¼š</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta=0.70\)</span>ï¼Œè¡¨ç¤ºæˆ‘ä»¬æ ¹æ®æ–‡çŒ®å¾—å‡ºçš„å…ˆéªŒå‡å€¼ï¼ˆ70%ï¼‰</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau^2\)</span>æ˜¯å…ˆéªŒçš„æ–¹å·®ï¼Œè¡¨ç¤ºæˆ‘ä»¬å¯¹è¿™ä¸ªå‡å€¼çš„åˆå§‹ä¸ç¡®å®šæ€§</p></li>
</ul>
<p><strong>ä¼¼ç„¶å‡½æ•°</strong></p>
<p>æ ¹æ®æ­£æ€åˆ†å¸ƒå‡è®¾ï¼Œæ ·æœ¬æ•°æ®çš„ä¼¼ç„¶å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<div class="math notranslate nohighlight">
\[
L(\mu|\overrightarrow{y})\propto \mathop{\prod} \limits_{i=1}^n exp[-\frac{(y_i-\mu)^2}{2\sigma^2}]
\]</div>
<p>å…¶ä¸­ï¼Œ<span class="math notranslate nohighlight">\(y_i\)</span>æ˜¯æ¯ä¸ªè¢«è¯•çš„è§‚æµ‹æ­£ç¡®ç‡ï¼Œ<span class="math notranslate nohighlight">\(\sigma^2\)</span>æ˜¯å·²çŸ¥çš„æ­£ç¡®ç‡æ–¹å·®</p>
<p><strong>æ­£æ€-æ­£æ€å…±è½­å…³ç³»</strong></p>
<p>ç”±äºæˆ‘ä»¬é€‰æ‹©äº†æ­£æ€åˆ†å¸ƒä½œä¸º<span class="math notranslate nohighlight">\(Î¼\)</span>çš„å…ˆéªŒï¼Œå¹¶ä¸”ä¼¼ç„¶å‡½æ•°ä¹Ÿæ˜¯æ­£æ€åˆ†å¸ƒï¼Œå› æ­¤ï¼Œåˆ©ç”¨æ­£æ€-æ­£æ€å…±è½­ï¼ŒåéªŒåˆ†å¸ƒä»ç„¶æ˜¯æ­£æ€åˆ†å¸ƒã€‚åéªŒåˆ†å¸ƒçš„å½¢å¼ä¸ºï¼š</p>
<div class="math notranslate nohighlight">
\[
\mu|\overrightarrow{y} \sim N(\frac{\theta \sigma^2+\overline{y}n\tau^2}{n\tau^2+\sigma^2},\frac{\tau^2\sigma^2}{n\tau^2+\sigma^2})
\]</div>
<p>å…¶ä¸­ï¼š</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\overline{y}\)</span>æ˜¯æ ·æœ¬çš„å‡å€¼ï¼ˆè§‚æµ‹åˆ°çš„å¹³å‡æ­£ç¡®ç‡ï¼‰</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma^2\)</span>æ˜¯å·²çŸ¥çš„æ­£ç¡®ç‡æ–¹å·®</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau^2\)</span>æ˜¯å…ˆéªŒçš„æ–¹å·®</p></li>
</ul>
<p><strong>åéªŒåˆ†å¸ƒåˆ†æ</strong></p>
<ul class="simple">
<li><p><strong>åéªŒå‡å€¼</strong>ï¼šåéªŒå‡å€¼æ˜¯å…ˆéªŒå‡å€¼<span class="math notranslate nohighlight">\(\theta\)</span>å’Œæ ·æœ¬å‡å€¼<span class="math notranslate nohighlight">\(\overline{y}\)</span>çš„åŠ æƒå¹³å‡ï¼š</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
posterior mean = \theta \frac{\sigma^2}{n\tau^2+\sigma^2}+\overline{y}\frac{n\tau^2}{n\tau^2+\sigma^2}
\]</div>
<ul class="simple">
<li><p><strong>åéªŒæ–¹å·®</strong>ï¼šåéªŒæ–¹å·®å—å…ˆéªŒçš„æ–¹å·®<span class="math notranslate nohighlight">\(r^2\)</span>å’Œæ ·æœ¬æ•°æ®çš„æ–¹å·®<span class="math notranslate nohighlight">\(\sigma^2\)</span>çš„å…±åŒå½±å“ï¼š</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
posterior variance = \frac{\tau^2\sigma^2}{n\tau^2+\sigma^2}
\]</div>
<p>éšç€æ ·æœ¬é‡<span class="math notranslate nohighlight">\(n\)</span>çš„å¢åŠ ï¼ŒåéªŒå‡å€¼é€æ¸ä¾èµ–äºè§‚æµ‹æ•°æ®ï¼Œè€Œå¯¹å…ˆéªŒçš„ä¾èµ–å‡å°ã€‚åŒæ—¶ï¼ŒåéªŒæ–¹å·®éšç€æ ·æœ¬é‡çš„å¢åŠ è€Œå‡å°ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯¹<span class="math notranslate nohighlight">\(Î¼\)</span>çš„ä¼°è®¡å°†å˜å¾—æ›´åŠ ç²¾ç¡®ã€‚</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># å®šä¹‰æ­£ç¡®ç‡èŒƒå›´</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>  <span class="c1"># æ­£ç¡®ç‡åœ¨0åˆ°1ä¹‹é—´</span>

<span class="c1"># å®šä¹‰å…ˆéªŒåˆ†å¸ƒ (åŸºäºæ–‡çŒ®ï¼Œæ­£ç¡®ç‡å‡å€¼ä¸º70%)</span>
<span class="n">prior_mean</span> <span class="o">=</span> <span class="mf">0.70</span>
<span class="n">prior_std</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">prior_y</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">prior_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">prior_std</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prior_mean</span><span class="p">,</span> <span class="n">prior_std</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># ç”Ÿæˆä¼¼ç„¶åˆ†å¸ƒ (åŸºäºæ–°å®éªŒæ•°æ®ï¼Œæ­£ç¡®ç‡å‡å€¼ä¸º75%)</span>
<span class="n">likelihood_mean</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">likelihood_std</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">likelihood_values</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">likelihood_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">likelihood_std</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">likelihood_mean</span><span class="p">,</span> <span class="n">likelihood_std</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># è®¡ç®—åéªŒåˆ†å¸ƒ</span>
<span class="n">posterior_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">prior_mean</span> <span class="o">*</span> <span class="n">likelihood_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">likelihood_mean</span> <span class="o">*</span> <span class="n">prior_std</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
    <span class="n">prior_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">likelihood_std</span><span class="o">**</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">posterior_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
    <span class="p">(</span><span class="n">prior_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">likelihood_std</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">prior_std</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">likelihood_std</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">posterior_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">posterior_std</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">posterior_mean</span><span class="p">,</span> <span class="n">posterior_std</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># ç»˜åˆ¶å…ˆéªŒã€ä¼¼ç„¶å’ŒåéªŒåˆ†å¸ƒ</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prior_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f0e442&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prior&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prior_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f0e442&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">likelihood_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0071b2&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;likelihood&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">likelihood_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#0071b2&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#009e74&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#009e74&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># è®¾ç½® x å’Œ y è½´æ ‡ç­¾</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\mu$ for accuracy (correct response rate)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># ç§»é™¤å›¾çš„ä¸Šã€å³è¾¹æ¡†çº¿</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="c1"># å±•ç¤ºå›¾åƒ</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>è¡¥å……ï¼šGamma-Poisson conjugate family</strong></p>
<p>Gamma-Poissonå…±è½­å®¶æ—æ˜¯ä¸€ç»„ç»Ÿè®¡æ¨¡å‹ï¼Œå…¶ä¸­Poissonåˆ†å¸ƒç”¨äºæè¿°è®¡æ•°æ•°æ®ï¼Œè€ŒGammaåˆ†å¸ƒä½œä¸ºå…¶å‚æ•°çš„å…ˆéªŒåˆ†å¸ƒã€‚</p>
<ul class="simple">
<li><p>Poissonåˆ†å¸ƒæ˜¯ä¸€ç§ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒï¼Œç”¨äºæè¿°åœ¨å›ºå®šæ—¶é—´é—´éš”æˆ–ç©ºé—´åŒºåŸŸå†…å‘ç”ŸæŸä¸€äº‹ä»¶çš„æ¬¡æ•°ã€‚</p></li>
<li><p>Gammaåˆ†å¸ƒæ˜¯ä¸€ç§è¿ç»­æ¦‚ç‡åˆ†å¸ƒï¼Œç”¨äºæè¿°ç­‰å¾…æ—¶é—´ç›´åˆ°ç¬¬kä¸ªäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´é•¿åº¦ï¼Œæˆ–è€…ä½œä¸ºæ­£æ€åˆ†å¸ƒæ–¹å·®çš„å…±è½­å…ˆéªŒã€‚</p></li>
</ul>
<p><strong>ä¾‹å­ï¼šéšæœºç‚¹è¿åŠ¨ä»»åŠ¡ä¸­çš„è¢«è¯•æ‹›å‹Ÿï¼š</strong></p>
<p>å‡è®¾ä¸€ä½å¿ƒç†å­¦ç ”ç©¶è€…æ¯å¤©éƒ½éœ€è¦æ¯å¤©æ‹›å‹Ÿæ–°çš„è¢«è¯•å‚ä¸éšæœºç‚¹è¿åŠ¨ä»»åŠ¡å®éªŒã€‚</p>
<p>ä»–è®¤ä¸ºå¹³å‡ä¸‹æ¥ï¼Œæ¯å¤©å¯ä»¥æ‹›å‹Ÿåˆ° 12 ä¸ªè¢«è¯•ï¼Œè¿™ä¸ªæ•°å­—å¤§çº¦åœ¨ 5 åˆ° 20 ä¹‹é—´æµ®åŠ¨ã€‚</p>
<p>æˆ‘ä»¬å‡è®¾ç ”ç©¶è€…å¹³å‡æ¯å¤©æ‹›å‹Ÿåˆ°çš„è¢«è¯•æ•°é‡ä¸º<span class="math notranslate nohighlight">\(\lambda\)</span></p>
<p>ğŸ¤”æˆ‘ä»¬è¯¥ä½¿ç”¨å“ªç§åˆ†å¸ƒæ¥æè¿°ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Ÿ</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šï¼š</p>
<ul class="simple">
<li><p>ä¸º<span class="math notranslate nohighlight">\(\lambda\)</span>é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å…ˆéªŒ</p></li>
<li><p>æ¥ç€æ”¶é›†æ•°æ®ï¼Œå¹¶ä¸”é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ•°æ®æ¨¡å‹</p></li>
<li><p>ç»“åˆå…ˆéªŒä¸æ•°æ®ï¼Œæ›´æ–°æˆ‘ä»¬å¯¹<span class="math notranslate nohighlight">\(\lambda\)</span>çš„ä¿¡å¿µ</p></li>
</ul>
<p><strong>Poissonåˆ†å¸ƒ</strong></p>
<p>æ³Šæ¾åˆ†å¸ƒ(Poisson distribution) é€‚ç”¨äºæè¿°åœ¨ä¸€å®šæ—¶é—´é—´éš”å†…äº‹ä»¶å‘ç”Ÿçš„æ¬¡æ•°ã€‚</p>
<p>Poissonåˆ†å¸ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°(pmf)å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<div class="math notranslate nohighlight">
\[
f(y)=\frac{\lambda^ye^{-\lambda}}{y^!}
\]</div>
<ul class="simple">
<li><p>Poissonåˆ†å¸ƒåªæœ‰ä¸€ä¸ªå‚æ•°<span class="math notranslate nohighlight">\(\lambda\)</span>ï¼Œè¡¨ç¤ºäº‹æƒ…å‘ç”Ÿå¹³å‡å‘ç”Ÿç‡(event rate)æˆ–äº‹ä»¶å‘ç”Ÿçš„æœŸæœ›æ¬¡æ•°ã€‚</p></li>
<li><p><span class="math notranslate nohighlight">\(y\)</span>æ˜¯æ•°æ®ï¼ŒæŒ‡åœ¨ä¸€å®šæ—¶é—´é—´éš”ä¸­äº‹ä»¶å‘ç”Ÿçš„æ¬¡æ•°ã€‚</p></li>
<li><p><span class="math notranslate nohighlight">\(f(y)\)</span>è¡¨ç¤ºåœ¨æŸå•ä½æ—¶é—´å†…ï¼ŒæŸäº‹ä»¶<span class="math notranslate nohighlight">\(y\)</span>å‘ç”Ÿçš„å¹³å‡æ¬¡æ•°çš„æ¦‚ç‡ã€‚</p></li>
</ul>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ç ”ç©¶è€…å¹³å‡æ¯å¤©å¯ä»¥æ‹›å‹Ÿ 12 ä¸ªè¢«è¯•ï¼ˆ<span class="math notranslate nohighlight">\(\lambda\)</span>=12ï¼‰ï¼Œé‚£ä¹ˆåœ¨ä¸€å¤©å†…æ‹›å‹Ÿåˆ° 5 ä¸ªè¢«è¯•çš„æ¦‚ç‡<span class="math notranslate nohighlight">\(f(5)\)</span>æ‹›å‹Ÿåˆ° 10 åè¢«è¯•çš„æ¦‚ç‡<span class="math notranslate nohighlight">\(f(10)\)</span>ï¼Œæˆ–æ‹›å‹Ÿåˆ° 15 åè¢«è¯•çš„æ¦‚ç‡<span class="math notranslate nohighlight">\(f(15)\)</span>éƒ½å¯ä»¥é€šè¿‡Poissonåˆ†å¸ƒè¿›è¡Œè®¡ç®—ã€‚</p>
<p><strong>Poissonåˆ†å¸ƒå›¾ç¤º</strong></p>
<p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒ<span class="math notranslate nohighlight">\(\lambda\)</span>ä¸‹ï¼Œäº‹ä»¶å‘ç”Ÿyæ¬¡çš„å¯èƒ½æ€§åˆ†å¸ƒ</p>
<p><img alt="alt text" src="../_images/image-135.png" /></p>
<p><strong>Potential priors</strong></p>
<p>ğŸ¤”æ€è€ƒï¼š</p>
<p>æˆ‘ä»¬æœ‰å¦‚ä¸‹å½¢å¼çš„Poisson ä¼¼ç„¶å‡½æ•°ï¼š</p>
<div class="math notranslate nohighlight">
\[
L(\lambda|\overrightarrow{y})=\frac{\lambda^{\sum y_i}e^{-n\lambda}}{\prod^n_{i=1}y_i!}\propto \lambda^ke^{-\tau\lambda}
\]</div>
<p>ä»å…¬å¼ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¼¼ç„¶å‡½æ•°å…·æœ‰ç±»ä¼¼äº<span class="math notranslate nohighlight">\(\lambda^ke^{-\tau\lambda}\)</span>çš„ç»“æ„</p>
<p>é‚£ä¹ˆï¼Œå“ªç§å…ˆéªŒåˆ†å¸ƒä¸è¿™ç§ä¼¼ç„¶å‡½æ•°ç›¸åŒ¹é…ï¼Œä»è€Œä½œä¸º Poisson åˆ†å¸ƒçš„å…±è½­å…ˆéªŒï¼Ÿ</p>
<p>1.Gammaæ¨¡å‹ï¼š<span class="math notranslate nohighlight">\(f(\lambda) \propto \lambda^{s-1}e^{-\tau\lambda}\)</span></p>
<p>2.Weibullæ¨¡å‹ï¼š<span class="math notranslate nohighlight">\(f(\lambda) \propto \lambda^{s-1}e^{(-\tau\lambda)^s}\)</span></p>
<p>3.â€Fâ€æ¨¡å‹ï¼š<span class="math notranslate nohighlight">\(f(\lambda) \propto \lambda^{\frac{s}{2}-1}(1+\lambda)^{-s}\)</span></p>
<p>ä»å½¢å¼ä¸Šçœ‹ï¼ŒGamma åˆ†å¸ƒä¸ Poisson ä¼¼ç„¶å‡½æ•°æœ€åŒ¹é…ï¼Œ
åœ¨ Poisson åˆ†å¸ƒä¸­ï¼ŒGamma åˆ†å¸ƒæ˜¯<span class="math notranslate nohighlight">\(\lambda\)</span>çš„å…±è½­å…ˆéªŒï¼Œè®¡ç®—åä¼šå¾—åˆ°ç®€ä¾¿çš„åéªŒåˆ†å¸ƒã€‚</p>
<p><strong>å…±è½­æ€§</strong></p>
<p>Gammaåˆ†å¸ƒæ˜¯ä¸€ç§è¿ç»­æ¦‚ç‡åˆ†å¸ƒï¼Œç”¨äºæè¿°ç­‰å¾…æ—¶é—´ç›´åˆ°ç¬¬kä¸ªäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´é•¿åº¦ï¼Œæˆ–è€…ä½œä¸ºæ­£æ€åˆ†å¸ƒæ–¹å·®çš„å…±è½­å…ˆéªŒã€‚å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰ç”±ä»¥ä¸‹å…¬å¼ç»™å‡ºï¼š</p>
<div class="math notranslate nohighlight">
\[
f(\lambda|\alpha,\beta) = \frac{\beta^\alpha \lambda^{\alpha-1}e^{-\beta\lambda}}{\Gamma(\alpha)}
\]</div>
<p>å…¶ä¸­ï¼Œ<span class="math notranslate nohighlight">\(\lambda\)</span>æ˜¯åˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œ<span class="math notranslate nohighlight">\(\alphaå’Œ\beta\)</span>æ˜¯Gammaåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°å’Œé€Ÿç‡ï¼ˆæˆ–å°ºåº¦ï¼‰å‚æ•°ï¼Œ<span class="math notranslate nohighlight">\(\Gamma(\alpha)\)</span>æ˜¯Gammaå‡½æ•°ã€‚</p>
<p>å½“ä½¿ç”¨Gammaåˆ†å¸ƒä½œä¸ºPoissonåˆ†å¸ƒå‚æ•°<span class="math notranslate nohighlight">\(\lambda\)</span>çš„å…ˆéªŒåˆ†å¸ƒæ—¶ï¼Œå¾—åˆ°çš„åéªŒåˆ†å¸ƒä¹Ÿå±äºGammaåˆ†å¸ƒã€‚è¿™ç§å…³ç³»ç§°ä¸ºå…±è½­æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœå…ˆéªŒåˆ†å¸ƒæ˜¯Gammaåˆ†å¸ƒï¼Œå³ï¼š</p>
<div class="math notranslate nohighlight">
\[
\lambda \sim Gamma(\alpha,\beta)
\]</div>
<p>å¹¶ä¸”æˆ‘ä»¬è§‚æµ‹åˆ°Poissonæ•°æ®<span class="math notranslate nohighlight">\(Y=y\)</span>ï¼Œé‚£ä¹ˆåéªŒåˆ†å¸ƒä¹Ÿæ˜¯Gammaåˆ†å¸ƒï¼Œå…¶å‚æ•°æ›´æ–°ä¸ºï¼š</p>
<div class="math notranslate nohighlight">
\[
\lambda|Y=y\sim Gamma(\alpha+y,\beta+1)
\]</div>
<p>è¿™ç§å…±è½­å…³ç³»ä½¿å¾—Gammaåˆ†å¸ƒæˆä¸ºPoissonåˆ†å¸ƒå‚æ•°çš„è‡ªç„¶é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¿æŒäº†æ•°å­¦ä¸Šçš„ç®€æ´æ€§ï¼Œä½¿å¾—åéªŒåˆ†å¸ƒçš„æ¨å¯¼å’Œåˆ†æå˜å¾—å®¹æ˜“ã€‚</p>
<p><strong>Critiques of conjugate family models</strong></p>
<p>å…±è½­æ—çš„ä¼˜åŠ¿åœ¨äºæ–¹ä¾¿ç†è§£å’Œè®¡ç®—ï¼Œè¿™ç§ä¾¿åˆ©æ€§ä¹Ÿå¸¦æ¥äº†ç¼ºç‚¹ï¼š</p>
<p>1.å…±è½­å…ˆéªŒæ¨¡å‹å¯èƒ½å¹¶ä¸èƒ½é€‚åº”ä½ çš„å…ˆéªŒä¿¡å¿µã€‚</p>
<ul class="simple">
<li><p>ä¾‹å¦‚ï¼Œæ­£æ€æ¨¡å‹æ€»æ˜¯å›´ç»•å‡å€¼<span class="math notranslate nohighlight">\(\mu\)</span>å¯¹ç§°ã€‚å› æ­¤ï¼Œå¦‚æœä½ çš„å…ˆéªŒè®¤è¯†ä¸æ˜¯å¯¹ç§°çš„ï¼Œé‚£ä¹ˆæ­£æ€å…ˆéªŒæ¨¡å‹å¯èƒ½å°±ä¸é€‚åˆä½œä¸ºå…ˆéªŒ</p></li>
</ul>
<p>2.å…±è½­æ—æ¨¡å‹å¹¶ä¸å…è®¸æœ‰ä¸€ä¸ªå®Œå…¨å¹³å¦çš„å…ˆéªŒ(uniform prior)ã€‚</p>
<ul class="simple">
<li><p>è™½ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<span class="math notranslate nohighlight">\(\alpha=\beta=1\)</span>æ¥ä½¿å¾— Beta å…ˆéªŒå˜å¾—æ›´åŠ å¹³å¦ï¼Œä½†æ— è®ºæ˜¯ Normal è¿˜æ˜¯ Gamma å…ˆéªŒï¼ˆæˆ–ä»»ä½•å…·æœ‰æ— é™æ”¯æŒçš„é€‚å½“æ¨¡å‹ï¼‰éƒ½æ— æ³•è°ƒæ•´ä¸ºå®Œå…¨å¹³å¦ã€‚</p></li>
<li><p>æˆ‘ä»¬èƒ½åšçš„æœ€å¥½çš„åŠæ³•å°±æ˜¯è°ƒæ•´å…ˆéªŒï¼Œä½¿å…¶å…·æœ‰éå¸¸é«˜çš„æ–¹å·®ï¼Œè¿™æ ·å®ƒä»¬å°±å‡ ä¹æ˜¯å¹³çš„äº†ã€‚</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter4_part1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lecture 5: Bayesian Inference: From Traditional Foundations to Current Practices</p>
      </div>
    </a>
    <a class="right-next"
       href="../chapter5/chapter5_part1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Leture6: MCMC</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">4.1 Grid approximation ç½‘æ ¼è¿‘ä¼¼</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-beta-binomial-example">A Beta-Binomial example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">ç¤ºä¾‹ï¼šç½‘ç»œè¿‘ä¼¼ä¼°è®¡åéªŒåˆ†å¸ƒ</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step1">Step1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step2-3">Step2&amp;3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step4">Step4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">ç»ƒä¹ </a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">æ¨¡å‹è®¾å®š</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mu-sigma">å¢åŠ éš¾åº¦ï¼šä¼°è®¡<span class="math notranslate nohighlight">\(\mu\)</span> å’Œ <span class="math notranslate nohighlight">\(\sigma\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">ç½‘æ ¼è¿‘ä¼¼çš„å±€é™æ€§</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#markov-chain-monte-carlo-mcmc">Markov chain Monte Carlo(MCMC)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcmc">MCMC çš„é‡‡æ ·ç‰¹ç‚¹</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr. Hu Chuan-Peng
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
# Part 3: éšæœºå˜é‡çš„è´å¶æ–¯æ¨¡å‹

## 1ã€éšæœºå˜é‡

&emsp;&emsp;åœ¨ä¹‹å‰çš„åˆ†æä¸­ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ˜¯å¯¹æŸé¡¹ç ”ç©¶çš„â€œå¯é‡å¤æ€§â€è¿™æ ·ä¸€ä¸ªå•ä¸€äº‹ä»¶ã€‚

&emsp;&emsp;åŒæ ·çš„é€»è¾‘å¯ä»¥åº”ç”¨äºæ›´åŠ æŠ½è±¡å’Œä¸€èˆ¬æ€§çš„**éšæœºå˜é‡**è¿›è¡Œåˆ†æã€‚

&emsp;&emsp;å‡è®¾ä¸ºäº†ç ”ç©¶å¯é‡å¤æ€§é—®é¢˜ï¼Œä¸€ä¸ªæœ‰èƒ½åŠ›ä¸”èµ„é‡‘å……è¶³çš„ç ”ç©¶å›¢é˜Ÿè®¡åˆ’è¿›è¡Œä¸€ç³»åˆ—å¯é‡å¤æ€§å®éªŒï¼Œä»–ä»¬å¸Œæœ›çŸ¥é“è¿™äº›å®éªŒæˆåŠŸé‡å¤çš„æ¯”ä¾‹æ˜¯å¤šå°‘ã€‚

&emsp;&emsp;é¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸ªæ¦‚å¿µï¼šèƒœç‡æˆ–æˆåŠŸç‡

- æƒ³è±¡ä½ ç©æ–—åœ°ä¸»ï¼Œæœ‰äº”å±€ä¸‰èƒœï¼Œä¸ƒå±€å››èƒœè¿™ä¸€è¯´ï¼Œä¸€è½®ç©ä¸‹æ¥ï¼Œå°±ä¼šå‡ºç°èƒœç‡
- ç„¶è€Œï¼Œèƒœç‡å¹¶ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œå®ƒä¼šéšç€æ¯æ¬¡æ¸¸æˆçš„è¾“èµ¢è€Œå˜åŒ–
- åœ¨æ¯ä¸€è½®å¼€å§‹å‰ï¼Œä½ å¹¶ä¸ä¼šçŸ¥é“ä½ è¿™æ¬¡çš„èƒœç‡æ˜¯å¤šå°‘

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå‡è®¾è®¡åˆ’å¯¹6é¡¹ç ”ç©¶è¿›è¡Œé‡å¤å®éªŒï¼š

- å‡è®¾è¯¥å›¢é˜Ÿå¯¹äºä»»ä½•ç ”ç©¶æˆåŠŸå¤ç°çš„æˆåŠŸç‡ä¸º$ Ï€ï¼ŒÏ€ $æ˜¯æœªçŸ¥çš„ä¸”å¯èƒ½ä¼šå˜åŒ–ï¼Œæ‰€ä»¥$ Ï€ $æ˜¯ä¸€ä¸ªéšæœºå˜é‡ã€‚
- æ ¹æ®å›¢é˜Ÿå…ˆå‰çš„ç»éªŒä»¥åŠå¿ƒç†å­¦ç ”ç©¶çš„ç°çŠ¶ï¼Œæˆ‘ä»¬çŒœæµ‹å…¶æˆåŠŸå¤ç°çš„æˆåŠŸç‡ä¸º$ Ï€ $=50%ã€‚
- ä»–æ¥ä¸‹æ¥å¯èƒ½æˆåŠŸå¤ç°çš„æ¬¡æ•°$Y$å¯èƒ½æ˜¯0ï¼Œå¯èƒ½æ˜¯1ï¼Œä¹Ÿå¯èƒ½æ˜¯6ï¼Œå¯ä»¥æœ‰7ç§å¯èƒ½çš„æˆåŠŸå¤ç°æ¬¡æ•°ï¼Œ$ Yâˆˆ $ {0,1,2,3,4,5,6}ã€‚

&emsp;&emsp;**æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šè™½ç„¶æˆ‘ä»¬çŸ¥é“ä»–ä»¬çš„å¹³å‡æˆåŠŸç‡ä¸º $ Ï€ $=50%ï¼Œä½†é—®é¢˜åœ¨äºï¼Œå¯¹äºæ¯ä¸€ç§å¤ç°æˆåŠŸçš„æ¬¡æ•°ï¼ˆ1ï½6ï¼‰ï¼Œå…¶å¯èƒ½æ€§åˆ†åˆ«æ˜¯å¤šå°‘å‘¢ï¼Ÿ**

## 2ã€äºŒé¡¹å¼æ¨¡å‹

&emsp;&emsp;ç”±äºæ¯æ¬¡é‡å¤å®éªŒï¼Œç»“æœåªæœ‰ä¸¤ç§å¯èƒ½ï¼š**æˆåŠŸ vs å¤±è´¥**

&emsp;&emsp;è¯¥å›¢é˜Ÿæ€»å…±è¿›è¡Œ6æ¬¡é‡å¤å®éªŒï¼Œæˆ‘ä»¬æƒ³è¦çŸ¥é“çš„æ˜¯æˆåŠŸ1æ¬¡ï¼ŒæˆåŠŸ2æ¬¡ï¼ŒæˆåŠŸ3æ¬¡ï¼Œ...ï¼Œçš„æ¦‚ç‡ã€‚

&emsp;&emsp;å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ç”¨äºŒé¡¹åˆ†å¸ƒæ¥åˆ†æã€‚

- è¯¥å›¢é˜Ÿçš„æˆåŠŸç‡ä¸º$Ï€$ï¼Œåœ¨$Ï€$ä¸‹æŸæˆåŠŸæ¬¡æ•°å‘ç”Ÿçš„æ¦‚ç‡å¯è¡¨ç¤ºä¸ºï¼š
<font size=5><center>
$ f(y|Ï€)=(^n_y)Ï€^y(1-Ï€)^{n-y} ~~~~~~for~yâˆˆ $ {$ 0,1,2....,n $}
$ (^n_y)=\frac{n!}{y!(n-y)!} $
</font></center>


$ Ï€ $è¡¨ç¤ºæˆåŠŸçš„å¯èƒ½æ€§ï¼Œ$ y $è¡¨ç¤ºåœ¨nä¸ªè¯•æ¬¡ä¸­æˆåŠŸçš„æ¬¡æ•°ï¼ŒäºŒé¡¹æ¨¡å‹å«æœ‰çš„å‰æå‡è®¾æ˜¯ï¼š

(1) æ‰€æœ‰è¯•æ¬¡å‘ç”Ÿéƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„
(2) åœ¨æ¯ä¸ªè¯•æ¬¡ä¸­ï¼ŒæˆåŠŸçš„æ¦‚ç‡éƒ½æ˜¯ä¸€ä¸ªå›ºå®šçš„å€¼$Ï€$

æˆåŠŸæ¬¡æ•°ä¸º0~6 çš„å¯èƒ½æ€§å¯ä»¥åˆ†åˆ«å†™æˆï¼š
<center>

$ f(Y=0|Ï€=0.5)=(^6_0)0.5^0(1-0.5)^6 $

$ f(Y=1|Ï€=0.5)=(^6_1)0.5^1(1-0.5)^5 $

...

$ f(Y=5|Ï€=0.5)=(^6_5)0.5^5(1-0.5)^1 $

$ f(Y=6|Ï€=0.5)=(^6_6)0.5^6(1-0.5)^0 $
</center>


æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç å¸®åŠ©è®¡ç®—ï¼Œå…¶ä¸­På¯¹åº”å…¬å¼ä¸­çš„$ Ï€ $ã€‚
```python
st.binom.pmf(y, n, p)
```

In [1]:
```python
# å¯¼å…¥æ•°æ®åŠ è½½å’Œå¤„ç†åŒ…ï¼špandas
import pandas as pd
# å¯¼å…¥æ•°å­—å’Œå‘é‡å¤„ç†åŒ…ï¼šnumpy
import numpy as np
# å¯¼å…¥åŸºæœ¬ç»˜å›¾å·¥å…·ï¼šmatplotlib
import matplotlib.pyplot as plt
# å¯¼å…¥é«˜çº§ç»˜å›¾å·¥å…· seaborn ä¸º sns
import seaborn as sns
# å¯¼å…¥ç»Ÿè®¡å»ºæ¨¡å·¥å…·åŒ… scipy.stats ä¸º st
import scipy.stats as st 

# è®¾ç½®APA 7çš„ç”»å›¾æ ·å¼
plt.rcParams.update({
    'figure.figsize': (4, 3),      # è®¾ç½®ç”»å¸ƒå¤§å°
    'font.size': 12,               # è®¾ç½®å­—ä½“å¤§å°
    'axes.titlesize': 12,          # æ ‡é¢˜å­—ä½“å¤§å°
    'axes.labelsize': 12,          # è½´æ ‡ç­¾å­—ä½“å¤§å°
    'xtick.labelsize': 12,         # xè½´åˆ»åº¦å­—ä½“å¤§å°
    'ytick.labelsize': 12,         # yè½´åˆ»åº¦å­—ä½“å¤§å°
    'lines.linewidth': 1,          # çº¿å®½
    'axes.linewidth': 1,           # è½´çº¿å®½åº¦
    'axes.edgecolor': 'black',     # è®¾ç½®è½´çº¿é¢œè‰²ä¸ºé»‘è‰²
    'axes.facecolor': 'white',     # è½´èƒŒæ™¯é¢œè‰²ï¼ˆç™½è‰²ï¼‰
    'xtick.direction': 'in',       # xè½´åˆ»åº¦çº¿å‘å†…
    'ytick.direction': 'out',      # yè½´åˆ»åº¦çº¿å‘å†…å’Œå‘å¤–
    'xtick.major.size': 6,         # xè½´ä¸»åˆ»åº¦çº¿é•¿åº¦
    'ytick.major.size': 6,         # yè½´ä¸»åˆ»åº¦çº¿é•¿åº¦
    'xtick.minor.size': 4,         # xè½´æ¬¡åˆ»åº¦çº¿é•¿åº¦ï¼ˆå¦‚æœå¯ç”¨æ¬¡åˆ»åº¦çº¿ï¼‰
    'ytick.minor.size': 4,         # yè½´æ¬¡åˆ»åº¦çº¿é•¿åº¦ï¼ˆå¦‚æœå¯ç”¨æ¬¡åˆ»åº¦çº¿ï¼‰
    'xtick.major.width': 1,        # xè½´ä¸»åˆ»åº¦çº¿å®½åº¦
    'ytick.major.width': 1,        # yè½´ä¸»åˆ»åº¦çº¿å®½åº¦
    'xtick.minor.width': 0.5,      # xè½´æ¬¡åˆ»åº¦çº¿å®½åº¦ï¼ˆå¦‚æœå¯ç”¨æ¬¡åˆ»åº¦çº¿ï¼‰
    'ytick.minor.width': 0.5,      # yè½´æ¬¡åˆ»åº¦çº¿å®½åº¦ï¼ˆå¦‚æœå¯ç”¨æ¬¡åˆ»åº¦çº¿ï¼‰
    'ytick.labelleft': True,       # yè½´æ ‡ç­¾å·¦ä¾§æ˜¾ç¤º
    'ytick.labelright': False      # ç¦ç”¨yè½´æ ‡ç­¾å³ä¾§æ˜¾ç¤º
})
```

In[2]:
```python
y = [0,1,2,3,4,5,6]  # æˆåŠŸæ¬¡æ•° 
n = 6                # é‡å¤ç ”ç©¶æ€»æ¬¡æ•°
p = 0.5              # å‡è®¾çš„æˆåŠŸæ¦‚ç‡

# è®¡ç®—æ¦‚ç‡å€¼
prob = st.binom.pmf(y, n, p)

result_table = pd.DataFrame({"æˆåŠŸæ¬¡æ•°":y, "æ¦‚ç‡":prob})
result_table
```

æ˜¾ç„¶ï¼Œå½“å›¢é˜Ÿçš„æˆåŠŸæ¦‚ç‡ä¸º 0.5 æ—¶ï¼Œå…¶åœ¨å…­æ¬¡ç ”ç©¶ä¸­è·å¾— y = 3 æ¬¡æˆåŠŸçš„æ¦‚ç‡æœ€é«˜(p = 0.3125)ã€‚

In [3]:
```python
# ç»˜åˆ¶ç°è‰²ç«–çº¿
for i, j in zip(y , prob):
    plt.plot([i, i], [j, 0], 'gray', linestyle='-', linewidth=1, zorder=1, )

# ç»˜åˆ¶é»‘è‰²ç‚¹(å„æˆåŠŸç‡æ¬¡æ•°çš„æˆåŠŸç‡)
plt.scatter(y, prob, c='black')

plt.ylabel('$f(y|\pi)$')
plt.xlabel('y')

plt.xlim(-0.2,6.2)
plt.ylim(0,0.5)
plt.show()
```

<center><img width = '400' height ='300' src="image-17.png">
</center>

## 3ã€æ¦‚ç‡è´¨é‡å¯†åº¦å‡½æ•°ï¼ˆprobability mass function, pmfï¼‰

**æ¦‚ç‡è´¨é‡å¯†åº¦å‡½æ•°ï¼šæ˜¯ç”¨æ¥æè¿°ç¦»æ•£å‹éšæœºå˜é‡åœ¨å„ç‰¹å®šå–å€¼ä¸Šçš„æ¦‚ç‡ã€‚**

ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒæˆåŠŸæ¬¡æ•°yåœ¨ä¸åŒçš„å–å€¼ä¸Šçš„æ¦‚ç‡ä¸åŒã€‚

- ç”±äºyçš„ä¸ªæ•°æ˜¯æœ‰é™çš„ï¼Œå¹¶ä¸”æ˜¯éšæœºå‘ç”Ÿçš„ï¼Œæˆ‘ä»¬æŠŠyç§°ä¸ºç¦»æ•£å‹éšæœºå˜é‡ï¼Œè€Œyå‘ç”Ÿçš„æ¦‚ç‡$ f(y) $åˆ™è¢«ç§°ä¸º**æ¦‚ç‡è´¨é‡å‡½æ•°**ã€‚

å¯¹äºç¦»æ•£å‹éšæœºå˜é‡$ Y $ï¼Œ$ Y $å„å–å€¼çš„æ¦‚ç‡ç”±$ f(y) $æŒ‡å®šï¼š

<center>

$ f(y)=P(Y = y) $
</center>

å¹¶ä¸”æœ‰å¦‚ä¸‹æ€§è´¨ï¼š

- å¯¹æ‰€æœ‰yçš„å–å€¼æ¥è¯´ï¼Œ$ 0 â‰¤ f(y) â‰¤ 1 $
- $ âˆ‘_{ally} f(y)=1 $ï¼Œyå–å€¼çš„æ‰€æœ‰æ¦‚ç‡ä¹‹å’Œä¸º1

In [4]:
```python
sum(result_table['æ¦‚ç‡'])
```

## 4ã€äºŒé¡¹ä¼¼ç„¶å‡½æ•°(The Binomial likelihood function)

**ä¸åŒçš„ä¿¡å¿µ**

&emsp;&emsp;è™½ç„¶æˆ‘ä»¬è®¤ä¸ºè¯¥å›¢é˜Ÿé‡å¤6ä¸ªå®éªŒçš„æˆåŠŸç‡æ˜¯50%ï¼Œä½†å¹¶éæ‰€æœ‰äººéƒ½è¿™ä¹ˆè®¤ä¸ºã€‚

- ä¹è§‚æ´¾è®¤ä¸ºè¯¥å›¢é˜Ÿçš„æˆåŠŸæ¦‚ç‡ä¸º 0.8ï¼Œè¡¨ç¤ºå¯¹å®éªŒæˆåŠŸå¤ç°æŒé«˜åº¦ä¿¡å¿ƒã€‚
- æ‚²è§‚æ´¾åˆ™è®¤ä¸ºè¯¥å›¢é˜Ÿçš„æˆåŠŸæ¦‚ç‡ä»…ä¸º 0.2ï¼Œæ„å‘³ç€å¯¹å®éªŒæˆåŠŸå¤ç°ä¸å¤ªä¹è§‚ã€‚

&emsp;&emsp;æˆåŠŸçš„æ¦‚ç‡å½±å“ç€ä»–ä»¬å¯¹ç ”ç©¶å¤ç°ç»“æœçš„é¢„æœŸï¼š

- å¦‚æœå›¢é˜Ÿçš„æˆåŠŸæ¦‚ç‡é«˜ï¼Œé‚£ä¹ˆ6æ¬¡ç ”ç©¶ä¸­æˆåŠŸå¤ç°çš„æ¬¡æ•°ä¼šæ›´å¤šã€‚
- åä¹‹ï¼Œå¦‚æœæˆåŠŸæ¦‚ç‡ä½ï¼Œé‚£ä¹ˆç ”ç©¶å¤ç°çš„å¤±è´¥æ¬¡æ•°å°±ä¼šæ›´å¤šã€‚

æˆ‘ä»¬å¯ä»¥è®¡ç®—æŒä¸åŒä¿¡å¿µçš„äººå¿ƒä¸­ï¼Œè¯¥å›¢é˜Ÿåœ¨6é¡¹ç ”ç©¶ä¸­æˆåŠŸå¤ç°çš„æ¬¡æ•°çš„æ¦‚ç‡åˆ†å¸ƒå¹¶ç”»å›¾ã€‚

In [5]:
```python
y = [0,1,2,3,4,5,6]  # æˆåŠŸæ¬¡æ•° 
n = 6                # ç ”ç©¶æ€»æ¬¡æ•°

# è®¡ç®—ä¼¼ç„¶å€¼
p = 0.5              # æ ¹æ®ä»¥å¾€æˆ˜ç»©å‡è®¾çš„æˆåŠŸæ¦‚ç‡
likelihood1 = st.binom.pmf(y, n, p)
p = 0.8              # Kasparovæ”¯æŒè€…çœ¼ä¸­çš„æˆåŠŸæ¦‚ç‡
likelihood2 = st.binom.pmf(y, n, p)
p = 0.2              # æ·±è“æ”¯æŒè€…çœ¼ä¸­çš„æˆåŠŸæ¦‚ç‡
likelihood3 = st.binom.pmf(y, n, p)

result_table = pd.DataFrame({
  "æˆåŠŸæ¬¡æ•°":y, 
  "æœ¬å›¢é˜Ÿ(pi=0.5)":likelihood1, 
  "æ‚²è§‚æ´¾(pi=0.2)":likelihood2, 
  "ä¹è§‚æ´¾(pi=0.8)":likelihood3})
result_table
```

In [6]:
```python
# åˆ›å»ºå­å›¾
fig, axs = plt.subplots(1, 3, figsize=(10, 4))

# ç»˜åˆ¶ä¸‰ä¸ªå›¾,æ¯ä¸ªå­å›¾ç±»ä¼¼åŸå›¾
three_pi = ["Team itself ($\pi = 0.5$)","Optimists ($\pi = 0.8$)","Pessimists ($\pi = 0.2$)"]
likelihoods = [likelihood1, likelihood2, likelihood3]
for i, ax in enumerate(axs):
    
    ax.scatter(y, likelihoods[i], c='black')
    
    for xx, yy in zip(y, likelihoods[i]):
        ax.plot([xx, xx], [yy, 0], 'gray', linestyle='-', linewidth=1, zorder=1)
    
    # æ·»åŠ facet
    ax.set_title(three_pi[i])

    ax.set_xlim(-0.2,6.2)
    ax.set_ylim(0,0.4)

fig.supylabel('$f(y|\pi)$')
fig.supxlabel('y')
plt.tight_layout()
plt.show()
```

&emsp;&emsp;æ˜¾ç„¶ï¼Œå¯¹äºä¹è§‚æ´¾æ¥è¯´ï¼Œå›¢é˜Ÿå–å¾—å…­æ¬¡æˆåŠŸçš„æ¦‚ç‡è¿œé«˜äºå…¶ä»–æˆåŠŸæ¬¡æ•°ã€‚è€Œå¯¹äºæ‚²è§‚æ´¾æ¥è¯´ï¼Œå›¢é˜Ÿå…¨è´¥çš„å¯èƒ½æ€§è¿œé«˜äºå…¶ä»–æˆåŠŸæ¬¡æ•°ã€‚

- æ¢å¥è¯è¯´ï¼Œè‹¥å›¢é˜Ÿåœ¨6é¡¹ç ”ç©¶ä¸­ä»…æˆåŠŸå¤ç°ä¸€æ¬¡ï¼Œè¿™ç§æƒ…å†µåœ¨ä½æˆåŠŸç‡ä¸‹(æ‚²è§‚æ´¾è®¾æƒ³çš„æƒ…å¢ƒ)æ›´å¯èƒ½å‡ºç°ï¼Œåœ¨é«˜æˆåŠŸç‡ä¸‹(ä¹è§‚æ´¾è®¾æƒ³çš„æƒ…å¢ƒ)å‡ ä¹ä¸å¯èƒ½å‡ºç°ã€‚
- é‚£ä¹ˆå›¢é˜ŸæˆåŠŸé‡å¤çš„æˆåŠŸç‡ï¼Œæ›´å¯èƒ½(likelihood)æ˜¯æ‚²è§‚æ´¾è®¾æƒ³çš„é‚£æ ·($ Ï€=0.2 $)ã€‚

&emsp;&emsp;ä¾‹å¦‚ï¼Œåœ¨ä¹è§‚æ´¾å’Œæ‚²è§‚æ´¾çœ¼ä¸­(ä¸åŒæˆåŠŸç‡$ Ï€ $ä¸‹)ï¼Œ6é¡¹ç ”ç©¶åªæˆåŠŸ1æ¬¡çš„å¯èƒ½æ€§(å³ä¼¼ç„¶ï¼Œlikelihood)ã€‚

In [7]:
```python
# å®šä¹‰æˆåŠŸæ¬¡æ•°å’Œç ”ç©¶æ€»æ¬¡æ•°
y = 1  # æˆåŠŸæ¬¡æ•°ï¼Œä½œä¸ºæ•°ç»„å¤„ç†ä»¥ä¾¿å‘é‡åŒ–è®¡ç®—
n = 6  # ç ”ç©¶æ€»æ¬¡æ•°

# è®¡ç®—ä¼¼ç„¶å€¼ï¼Œå¯¹äºä¸‰ç§ä¸åŒçš„æˆåŠŸæ¦‚ç‡ p
p_values = [0.5, 0.8, 0.2]          # å®šä¹‰ä¸‰ç§æˆåŠŸç‡
likelihoods = []                    # ç”¨äºå­˜å‚¨æ¯ç§æˆåŠŸç‡çš„ä¼¼ç„¶å€¼ç»“æœ

for p in p_values:
    likelihood = st.binom.pmf(y, n, p)  # ä½¿ç”¨st.binom.pmfè®¡ç®—ä¼¼ç„¶å€¼
    likelihoods.append(likelihood)      # å°†ç»“æœæ·»åŠ åˆ°åˆ—è¡¨ä¸­


# åˆ›å»ºå›¾å½¢å’Œå­å›¾
fig, ax = plt.subplots()  # æ­¤å¤„åº”è¯¥æ˜¯ plt.subplots() è€Œä¸æ˜¯ plt.subplot()
ax.scatter(p_values, likelihoods, c='black')
# è®¾ç½®xè½´å’Œyè½´çš„é™åˆ¶åº”è¯¥åœ¨ç»˜åˆ¶çº¿æ¡ä¹‹å‰å®Œæˆï¼Œä»¥é¿å…é‡å¤è®¾ç½®
ax.set_xlim(-0.2, 1.2)  # xè½´èŒƒå›´æ ¹æ®p_valuesè°ƒæ•´ï¼Œæœ€å¤§ä¸åº”è¶…è¿‡1
ax.set_ylim(0, 0.5)
for xx, yy in zip(p_values, likelihoods):
    ax.plot([xx, xx], [0, yy], 'gray', linestyle='-', linewidth=1, zorder=1)
    # æ³¨æ„è¿™é‡Œçš„é¡ºåºæ˜¯ [0, yy] è€Œä¸æ˜¯ [yy, 0]ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›ä»xè½´ç”»åˆ°å¯¹åº”çš„ä¼¼ç„¶å€¼
# è®¾ç½®åæ ‡è½´æ ‡ç­¾ï¼Œç›´æ¥ä½¿ç”¨axçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯figçš„æ–¹æ³•
ax.set_ylabel('$f(\pi|y)$')  # ä½¿ç”¨ax.set_ylabelè€Œä¸æ˜¯fig.supylabel
ax.set_xlabel('$\pi$')         # ä½¿ç”¨ax.set_xlabelè€Œä¸æ˜¯fig.supxlabel
plt.tight_layout()  # è°ƒæ•´å¸ƒå±€ä»¥é¿å…æ ‡ç­¾é‡å 
plt.show()
```

## 5ã€ä¼¼ç„¶å‡½æ•°

å½“å›¢é˜ŸåªæˆåŠŸå¤ç°ä¸€æ¬¡æ—¶ï¼Œè¯¥äº‹ä»¶åœ¨ä¸åŒæˆåŠŸç‡ä¸‹å‡ºç°çš„å¯èƒ½æ€§å¯ä»¥å†™ä¸ºï¼š

<center>

$ f(Y=1|Ï€=0.2)=(^6_1)0.2^1(1-0.2)^5 $

$ f(Y=1|Ï€=0.5)=(^6_1)0.5^1(1-0.5)^5 $



$ f(Y=1|Ï€=0.8)=(^6_1)0.8^1(1-0.8)^5 $
</center>



å› æ­¤ï¼ŒæˆåŠŸå¤ç°æ¬¡æ•°ä¸º1æ—¶çš„ä¼¼ç„¶å‡½æ•°å¯ä»¥å†™æˆï¼š

<center>

$ L(Ï€|y=1)=f(y=1|Ï€)=(^6_1)Ï€^1(1-Ï€)^{6-1}=6Ï€(1-Ï€)^5 $
</center>



ä¸åŒæˆåŠŸç‡ä¸‹çš„ä¼¼ç„¶ï¼š
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">

| $ Ï€ $ | 0.2 | 0.5 |0.8|
| :-----------: | :-----------: |:-----------: |:-----------:|
| $ f(Ï€ \vert y=1) $|0.3932|0.0938|0.0015|
</div>

**æ³¨æ„ï¼š**

ä¼¼ç„¶å‡½æ•°è¡¨ç¤ºçš„æ˜¯ï¼Œåœ¨å„ç§å¯èƒ½çš„æˆåŠŸç‡Ï€ä¸‹,æˆåŠŸæ¬¡æ•°Y=1çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥
- è¯¥ä¼¼ç„¶å‡½æ•°å…¬å¼åªå–å†³äºÏ€
- ä¼¼ç„¶å‡½æ•°çš„æ€»å’ŒåŠ èµ·æ¥ä¸ä¸º1ï¼ˆä»æ¡ä»¶æ¦‚ç‡çš„å…¬å¼æ¥çœ‹ï¼Œä¼¼ç„¶å‡½æ•°çš„åˆ†æ¯æ˜¯ä¸åŒçš„ï¼‰

**æ¡ä»¶æ¦‚ç‡ vs ä¼¼ç„¶å‡½æ•°**

å½“$ Ï€ $æ˜¯ä¸€å®šæ—¶ï¼Œæ¡ä»¶æ¦‚ç‡è´¨é‡å‡½æ•°$ f(Â·|Ï€) $å¯ä»¥å¸®æˆ‘ä»¬è®¡ç®—åœ¨Ï€å–å€¼ä¸‹ï¼ˆå„ç§æ¨¡å‹ï¼‰ï¼Œä¸åŒçš„æ•°æ®$ Y(e.g., y1,y2) $å‘ç”Ÿçš„å¯èƒ½æ€§ã€‚
<center>

$ f(y_1|Ï€)~vs~f(y_2|Ï€) $
</center>

å½“$ Y=y $ä¸€å®šæ—¶ï¼Œä¼¼ç„¶å‡½æ•°$ L(Â·|y)=f(y|Â·) $å…è®¸æˆ‘ä»¬æ¯”è¾ƒåœ¨å„ç§ä¸åŒçš„æ¨¡å‹ï¼Œå³äºŒé¡¹å¼çš„$ Ï€ $å–å€¼$ ï¼ˆe.g., Ï€_1,Ï€_2ï¼‰ $ä¸‹ï¼Œè§‚å¯Ÿåˆ°è¿™ä¸ªæ•°æ®yçš„å¯èƒ½æ€§ï¼ˆrelative likelihoodï¼‰

<center>

$ L(Ï€_1|y)ä¸L(Ï€_2|y) $

å³

$ f(y|Ï€_1)ä¸f(y|Ï€_2) $
</center>


**åœ¨äºŒé¡¹åˆ†å¸ƒæ¨¡å‹ä¸‹ï¼š**

è¿›è¡Œn=6ä¸ªé‡å¤å®éªŒæ—¶ï¼ŒæˆåŠŸæ¬¡æ•°ä¸æˆåŠŸç‡çš„å…³ç³»ç¬¦åˆäºŒé¡¹å¼æ¨¡å‹ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹çš„å½¢å¼æ¥è¡¨ç¤ºï¼š
<center>

$ Y|Ï€\sim Bin(6,Ï€) $

$ f(y|Ï€)=(^6_y)Ï€^y(1-Ï€)^{6-y}~~~~~~~for~y\in $ {0,1,2,3,4,5,6}

</center>


ä¸‹å›¾ç»™å‡ºäº†å‡ ç§$ Ï€ $çš„å–å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¦‚ç‡æ¨¡å‹å¾—åˆ°æ¯ç§$ Y $å‘ç”Ÿçš„å¯èƒ½æ€§ã€‚

- åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ$ Y=1 $(èµ¢ä¸€æ¬¡)è¿™ä¸€ç‰¹å®šçš„æ•°æ®æ¨¡å¼ï¼Œåœ¨å„ä¸ª$ Ï€ $
å–å€¼(æ¨¡å‹)ä¸‹çš„ä¼¼ç„¶ã€‚

In [8]:
```python
# Values for Y (number of successes in n trials)
y = np.arange(0, 7)
# Number of trials (n) and different probabilities (Ï€ values)
n = 6
pi_values = [0.2, 0.5, 0.8]

# Create subplots
fig, axs = plt.subplots(1, 3, figsize=(12, 5))
# Loop over each pi value to plot the corresponding binomial distribution
for i, pi in enumerate(pi_values):
    # Calculate binomial probabilities for each y (number of successes)
    likelihoods = st.binom.pmf(y, n, pi)
    
    # Scatter plot of the likelihoods
    axs[i].scatter(y, likelihoods, color='black', zorder=2)
    
    # Draw gray vertical lines
    for yy, likelihood in zip(y, likelihoods):
        axs[i].plot([yy, yy], [0, likelihood], color='gray', linestyle='-', linewidth=1, zorder=1)
    
    # Highlight y = 1 with a black line
    axs[i].plot([1, 1], [0, st.binom.pmf(1, n, pi)], color='black', linewidth=3, zorder=3)
    
    # Title with binomial parameters
    axs[i].set_title(f'Bin({n},{pi})')
    
    # Set y and x axis limits
    axs[i].set_xlim(-0.5, 6.5)
    axs[i].set_ylim(0, 0.5)

# Global labels
fig.supylabel(r'$f(y|\pi)$')
fig.supxlabel('y')

# Adjust layout for better fit
plt.tight_layout()
plt.show()
```

<center><img width = '800' height ='220' src="image-22.png">
</center>

## 6ã€å…ˆéªŒæ¦‚ç‡æ¨¡å‹(Prior probability model)

**å»ºç«‹å…ˆéªŒæ¨¡å‹**

ä»å‰é¢çš„æè¿°å¯ä»¥çœ‹åˆ°ï¼ŒäºŒé¡¹åˆ†å¸ƒçš„å‚æ•°Ï€ä¹Ÿå¯ä»¥å˜åŒ–ï¼Œä¹Ÿå¯ä»¥æˆä¸ºä¸€ä¸ªéšæœºå˜é‡ã€‚

- ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³å½“ä¸€ä¸ªæ›´æœ‰æ·±åº¦çš„è§‚å¯Ÿè€…ï¼Œèåˆäº†ä¹è§‚æ´¾ã€æ‚²è§‚æ´¾å’Œä¸­ç«‹è€…ä¸‰è€…å…³äºÏ€çš„ä¼°è®¡ã€‚
- ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯¹ä¸‰ç§è§‚ç‚¹çš„å¯èƒ½æ€§æœ‰ä¸åŒçš„ä¿¡å¿µã€‚

å‡å¦‚æˆ‘ä»¬æ€»ä½“ä¸Šæ˜¯ä¸€ä¸ªä¹è§‚æ´¾ï¼Œä½†ä¸æ’é™¤æ‚²è§‚æ´¾çš„è§‚ç‚¹ï¼Œæˆ‘ä»¬ç»™ä¸‰æ´¾è§‚ç‚¹åˆ†é…äº†ä¸€å®šçš„æ¦‚ç‡(å…ˆéªŒ)ã€‚

- ä¾‹å¦‚ï¼Œè®¾å®š$ Ï€_{0.2}=0.1 $ï¼Œæˆ–è€…$ Ï€_{0.2}=0.5 $ã€‚ä½†éœ€è¦æ‰€æœ‰$ f(Ï€) $çš„æ€»å’Œä¸º1ã€‚

<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">

| $ Ï€ $ | 0.2 | 0.5 |0.8|total|
| :-----------: | :-----------: |:-----------: |:-----------:|:-----------:|
| $ f(Ï€) $|0.10|0.25|0.65|1|
</div>

æˆ‘ä»¬è®¾å®šçš„Ï€çš„æ•°é‡ä¹Ÿæ˜¯å¯ä»¥å˜åŒ–çš„ã€‚

- ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†ä¸€ç§éå¸¸æ‚²è§‚çš„å¯èƒ½æ€§ä¹Ÿçº³å…¥è¿›æ¥ï¼Œè®¤ä¸ºè¯¥å›¢é˜ŸæˆåŠŸç‡ä¸º0.01ï¼Œå³$ Ï€ $=0.01ã€‚
- é‚£ä¹ˆæ–°å½¢æˆçš„å…ˆéªŒåˆ†å¸ƒå¯èƒ½å¦‚ä¸‹ã€‚
<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">

| $ Ï€ $ | 0.01 | 0.2 |0.5|0.8|total|
| :-----------: | :-----------: |:-----------: |:-----------:|:-----------:|:-----------:|
| $ f(Ï€) $|0.10|0.10|0.25|0.55|1|
</div>

## 7ã€åéªŒæ¦‚ç‡æ¨¡å‹(Posterior probability model)

å‰è¿°ç¬¬ä¸€ä¸ªå…ˆéªŒæ¨¡å‹ï¼Œæˆ‘ä»¬æ€»ä½“ä¸Šæ˜¯ä¹è§‚çš„ï¼Œè®¤ä¸ºå›¢é˜Ÿé«˜æˆåŠŸç‡çš„å¯èƒ½æ€§å¾ˆé«˜ ($ Ï€_{0.8}=0.65 $)ã€‚

<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">

| $ Ï€ $ | 0.2 | 0.5 |0.8|total|
| :-----------: | :-----------: |:-----------: |:-----------:|:-----------:|
| $ f(Ï€) $|0.10|0.25|0.65|1|
</div>

ç„¶è€Œï¼Œæœ€ç»ˆç»“æœå‘ç°ï¼šè¯¥å›¢é˜ŸåªæˆåŠŸå¤ç°ä¸€æ¬¡ã€‚

**è¿™ä¸ªæ–°çš„æ•°æ®ä¼šå¦‚ä½•æ”¹å˜æˆ‘ä»¬çš„ä¿¡å¿µï¼Ÿ**

æˆ‘ä»¬å¯ä»¥ç»¼åˆå…ˆéªŒå’Œä¼¼ç„¶ï¼Œæ ¹æ®è´å¶æ–¯çš„æ€è·¯ï¼Œè®¡ç®—åéªŒæ¦‚ç‡ã€‚

å…¶ä¸­ å›¢é˜ŸæˆåŠŸå¤ç°çš„æ¦‚ç‡ä»$ Ï€_{0.8}=0.65 $é™ä½ä¸º$ Ï€_{0.8}=0.015 $ã€‚æ„å‘³ç€ï¼Œä»–æˆåŠŸç‡ä¸º0.2çš„å¯èƒ½æ€§æ˜¯æœ€å¤§çš„$ Ï€_{0.2}=0.617 $ã€‚

- å·¦å›¾ä¸ºå…ˆéªŒæ¨¡å‹
- ä¸­é—´çš„å›¾ä¸ºä¼¼ç„¶æ¨¡å‹
- å³è¾¹çš„å›¾ä¸ºåéªŒæ¨¡å‹

In [9]:
```python
# Pi values and corresponding data
pi_values = [0.2, 0.5, 0.8]
f_pi = [0.10, 0.25, 0.65]  # Prior probabilities
L_pi_given_Y1 = [0.617, 0.367, 0.015]  # Likelihoods given Y=1
posterior = [0.617, 0.367, 0.015]  # Posterior, assumed same as likelihoods here

# Create subplots for prior, likelihood, and posterior
fig, axs = plt.subplots(1, 3, figsize=(10, 4))

# Prior Probability f(Ï€)
axs[0].scatter(pi_values, f_pi, color='black', zorder=2)
for xx, yy in zip(pi_values, f_pi):
    axs[0].plot([xx, xx], [0, yy], color='black', linewidth=3, zorder=1)
axs[0].set_title(r'Prior $f(\pi)$')
axs[0].set_xlim(0.15, 0.85)
axs[0].set_ylim(0, 0.7)

# Likelihood L(Ï€|Y=1)
axs[1].scatter(pi_values, L_pi_given_Y1, color='black', zorder=2)
for xx, yy in zip(pi_values, L_pi_given_Y1):
    axs[1].plot([xx, xx], [0, yy], color='black', linewidth=3, zorder=1)
axs[1].set_title(r'Likelihood $L(\pi|Y=1)$')
axs[1].set_xlim(0.15, 0.85)
axs[1].set_ylim(0, 0.7)

# Posterior Probability f(Ï€|Y=1)
axs[2].scatter(pi_values, posterior, color='black', zorder=2)
for xx, yy in zip(pi_values, posterior):
    axs[2].plot([xx, xx], [0, yy], color='black', linewidth=3, zorder=1)
axs[2].set_title(r'Posterior $f(\pi|Y=1)$')
axs[2].set_xlim(0.15, 0.85)
axs[2].set_ylim(0, 0.7)

# Set labels and layout
for ax in axs:
    ax.set_xlabel(r'$\pi$')

fig.supylabel('Probability')
plt.tight_layout()
plt.show()
```

<center><img width = '800' height ='240' src="image-23.png">
</center>

**åéªŒæ¨¡å‹çš„è®¡ç®—è¿‡ç¨‹**


ä¸Šå›¾æ‰€è¡¨ç¤ºçš„åéªŒå¯å†™æˆï¼š

<center>

$ f(Ï€|y)=1 $
</center>

è¡¨ç¤ºå½“å›¢é˜ŸåªæˆåŠŸå¤ç°ä¸€é¡¹ç ”ç©¶æ—¶ï¼Œä»–æˆåŠŸç‡$Ï€$çš„æ¦‚ç‡åˆ†å¸ƒ

æ ¹æ®è´å¶æ–¯å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥å¯¹åéªŒæ¦‚ç‡å…¬å¼è¿›è¡Œå±•å¼€ï¼š

<center>

$ posterior=\frac{prior*likelihood}{normalizing~constant} $

$ f(Ï€|y=1)=\frac{f(Ï€)L(Ï€|y=1)}{f(y=1)}~~~~~for~Ï€\in 0.2,0.5,0.8 $

$ f(Ï€=0.2|y=1)=\frac{0.10Ã—0.3932}{0.0637}â‰ˆ0.617 $

$ f(Ï€=0.5|y=1)=\frac{0.25Ã—0.0938}{0.0637}â‰ˆ0.368 $


$ f(Ï€=0.8|y=1)=\frac{0.65Ã—0.0015}{0.0637}â‰ˆ0.015 $

</center>

ä¸‹è¡¨å¯¹åéªŒæ¦‚ç‡æ¨¡å‹è¿›è¡Œäº†æ€»ç»“ï¼Œæˆ‘ä»¬å¯çŸ¥ï¼Œç»è¿‡äº†å…ˆå‰åªæˆåŠŸäº†ä¸€é¡¹ç ”ç©¶çš„å¤ç°ç»å†åï¼Œè¯¥å›¢é˜Ÿå–å¾—æˆåŠŸ($ Ï€=0.8 $)çš„å¯èƒ½æ€§å·²ç»ä»0.65é™åˆ°äº†0.015

<style>
.center 
{
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="center">

| $ Ï€ $ | 0.2 | 0.5 |0.8|total|
| :-----------: | :-----------: |:-----------: |:-----------:|:-----------:|
| $ f(Ï€) $|0.10|0.25|0.65|1|
|$ f(Ï€ \vert y=1 $)|0.617|0.368|0.015|1|
</div>

**è¡¥å……ææ–™**

çœç•¥åˆ†æ¯çš„è®¡ç®—

- è€ƒè™‘åˆ°åˆ†æ¯æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šæˆåŠŸç‡è®¡ç®—å®ƒ

çœç•¥åˆ†æ¯åéªŒçš„è®¡ç®—å¯å†™æˆï¼š

<center>

$ f(Ï€=0.2|y=1)=cÂ·0.10Â·0.3932âˆ0.039320 $
$ f(Ï€=0.5|y=1)=cÂ·0.25Â·0.0938âˆ0.023450 $
$ f(Ï€=0.8|y=1)=cÂ·0.65Â·0.0015âˆ0.000975 $

âˆè¡¨ç¤ºæˆæ¯”ä¾‹ï¼Œå°½ç®¡è¿™äº›æœªç»æ ‡å‡†åŒ–çš„åéªŒæ¦‚ç‡æ€»å’Œä¸ç­‰äº1

0.039320+0.023450+0.000975=0.063745
</center>
ä½†å®ƒä»¬çš„æ¯”ä¾‹å…³ç³»å¹¶æœªæ”¹å˜ï¼ˆè§ä¸‹å›¾ï¼‰

In [10]:
```python
# Pi values and corresponding unnormalized posterior data
pi_values = [0.2, 0.5, 0.8]
unnormalized_posterior = [0.03932, 0.02345, 0.000975]  # Unnormalized posterior values
normalized_posterior = [val / sum(unnormalized_posterior) for val in unnormalized_posterior]  # Normalized

# Create subplots for normalized and unnormalized posteriors
fig, axs = plt.subplots(1, 2, figsize=(8, 4))

# Normalized posterior
axs[0].scatter(pi_values, normalized_posterior, color='black', zorder=2)
for xx, yy in zip(pi_values, normalized_posterior):
    axs[0].plot([xx, xx], [0, yy], color='black', linewidth=3, zorder=1)
axs[0].set_title('Normalized $f(\pi | y=1)$')
axs[0].set_xlim(0.15, 0.85)
axs[0].set_ylim(0, 0.7)

# Unnormalized posterior
axs[1].scatter(pi_values, unnormalized_posterior, color='black', zorder=2)
for xx, yy in zip(pi_values, unnormalized_posterior):
    axs[1].plot([xx, xx], [0, yy], color='black', linewidth=3, zorder=1)
axs[1].set_title('Unnormalized $f(\pi | y=1)$')
axs[1].set_xlim(0.15, 0.85)
axs[1].set_ylim(0, 0.05)

# Set labels and layout
for ax in axs:
    ax.set_xlabel(r'$\pi$')

fig.supylabel('Probability')
plt.tight_layout()
plt.show()
```

<center><img width = '550' height ='250' src="image-26.png">
</center>

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æœªç»æ ‡å‡†åŒ–çš„åéªŒæ¦‚ç‡æ€»å’Œä½œä¸ºåˆ†æ¯ï¼Œæ¥å¯¹åéªŒæ¦‚ç‡è¿›è¡Œæ ‡å‡†åŒ–ï¼Œä¼šå¾—åˆ°ç›¸åŒçš„è®¡ç®—ç»“æœã€‚
<center>

$ f(Ï€=0.2|y=1)=\frac{0.039320}{0.039320+0.023450+0.000975} $


æ³¨æ„ï¼Œåˆ†æ¯ä¸ºæ‰€æœ‰ä¼¼ç„¶å€¼çš„æ€»å’Œï¼Œå› æ­¤åéªŒæ¦‚ç‡çš„è®¡ç®—å…¬å¼è¿˜å¯ä»¥å†™æˆï¼š

$ f(Ï€|y)=\frac{f(Ï€)L(Ï€|y)}{f(y)}=\frac{f(Ï€)L(Ï€|y)}{\sum _{allÏ€}f(Ï€)L(Ï€|y)} $

</center>

**Proportionality**

æ—¢ç„¶$ f(y) $æ˜¯ä¸€ä¸ªç”¨æ¥æ ‡å‡†åŒ–çš„å¸¸æ•°ï¼Œå®ƒå¹¶ä¸å—$ Ï€ $çš„å½±å“ï¼Œé‚£ä¹ˆåéªŒæ¦‚ç‡è´¨é‡å‡½æ•°$ f(Ï€|y) $å°±ä¸$ f(Ï€) $å’Œ$ L(Ï€|y) $æˆæ­£æ¯”

<center>

$ f(Ï€|y)=\frac{f(Ï€)L(Ï€|y)}{f(y)}âˆf(Ï€)L(Ï€|y) $

$ posteriorâˆpriorÂ·likelihood $
</center>

- ğŸ˜œ**è¿™ä¸ªæ€§è´¨å¾ˆé‡è¦ã€‚å› ä¸ºåˆ†æ¯çš„è®¡ç®—é‡å¾€å¾€æ¯”è¾ƒå¤§ï¼Œéœ€è¦éå†æ‰€æœ‰å‚æ•°ï¼Œå¦‚æœå‚æ•°ä¸æ­¢ä¸€ä¸ªï¼Œè®¡ç®—é‡å¯æƒ³è€ŒçŸ¥ã€‚å› æ­¤ï¼Œå¦‚è¿‡èƒ½ä¸è®¡ç®—åˆ†æ¯ä¹Ÿèƒ½è®¡ç®—åéªŒï¼Œé‚£ä¹ˆè¿™æ ·çš„æ–¹æ³•(åé¢ä¼šä»‹ç»çš„MCMCç®—æ³•)å°†ä¼šéå¸¸æœ‰å®è·µæ„ä¹‰ã€‚**

## 8ã€Posterior simulation (with code)

1. å®šä¹‰å…ˆéªŒæ¨¡å‹
- å®šä¹‰å¤šä¸ªå¯èƒ½çš„æˆåŠŸç‡
- å®šä¹‰æ¯ä¸ªæˆåŠŸç‡å‡ºç°çš„å¯èƒ½æ€§ (æ³¨æ„ï¼Œå…¶å’Œä¸º1)

In [11]:
```python
import pandas as pd
import numpy as np

# å®šä¹‰å¯èƒ½çš„æˆåŠŸç‡
replicated = pd.DataFrame({'pi':[0.2, 0.5, 0.8]})

# å®šä¹‰å…ˆéªŒæ¨¡å‹
prior = [0.10, 0.25, 0.65]
```

2. æ¨¡æ‹Ÿåœ¨ç‰¹å®šæˆåŠŸç‡ä¸‹ï¼Œ6é¡¹ç ”ç©¶ä¸­çš„æˆåŠŸæ¬¡æ•°

- é‡å¤è¿™ä¸ªè¿‡ç¨‹10000æ¬¡

In [12]:
```python
# è®¾ç½®éšæœºæ•°ç§å­ä¿è¯å¯é‡å¤æ€§
np.random.seed(84735)

# ä»å…ˆéªŒä¸­æŠ½å–10000ä¸ª pi å€¼ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„yå€¼

replicated_sim = replicated.sample(n=10000, weights=prior, replace=True)
replicated_sim['y'] = np.random.binomial(n=6, p=replicated_sim['pi'], size=len(replicated_sim))
replicated_sim.head(10)
```

In [13]:
```python
#å¯¹piçš„æŠ½å–æƒ…å†µè¿›è¡Œæ€»ç»“
replicated_counts =  replicated_sim['pi'].value_counts().reset_index()

replicated_counts.columns = ['pi','n']

replicated_counts['percentage'] = (replicated_counts['n']/len(replicated_sim))

replicated_counts = replicated_counts.sort_values(by='pi')

print(replicated_counts)
```

3. ä¸åŒæˆåŠŸç‡ä¸‹ï¼Œä¸åŒæˆåŠŸæ¬¡æ•°çš„åˆ†å¸ƒæƒ…å†µf(y|Ï€)

In [14]:
```python
# å¯¼å…¥ç»˜å›¾å·¥å…· seaborn
import seaborn as sns
# é€šè¿‡ facegrid æ–¹æ³•æ ¹æ®ä¸åŒå˜é‡ç»˜åˆ¶ä¸åŒçš„å›¾å½¢
replicated_lik = sns.FacetGrid(replicated_sim,col="pi")
replicated_lik.map(sns.histplot,'y',stat='probability',discrete=True)
plt.tight_layout()
plt.show()
```

4. æŸ¥çœ‹$y=1$æ—¶ï¼Œå¯¹åº”çš„$Ï€$çš„åˆ†å¸ƒæƒ…å†µ

In [15]:
```python
replicated_post = replicated_sim[replicated_sim['y'] == 1].value_counts()
replicated_post

replicated_post = replicated_sim[replicated_sim['y'] == 1]

replicated_post_plot = sns.histplot(data = replicated_post, x="pi")

#plt.xticks(np.arange(0.2,0.8,0.3))

replicated_post_plot.set(xticks=[0.2,0.5,0.8])
sns.despine()
```

**æ€è€ƒï¼šé¢‘ç‡å­¦æ´¾(ç»å…¸ç»Ÿè®¡)ä¼šå¦‚ä½•å¤„ç†ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼Ÿ**

- æŸé¡¹ç ”ç©¶çš„å¯é‡å¤æ€§
- é‡å¤6æ¬¡çš„æˆåŠŸç‡
